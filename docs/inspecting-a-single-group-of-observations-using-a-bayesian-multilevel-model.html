<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 2 Inspecting a ‘single group’ of observations using a Bayesian multilevel model | Bayesian multilevel models in R: A conceptual and practical introduction for linguists</title>
  <meta name="description" content="Bayesian Models for Linguists" />
  <meta name="generator" content="bookdown 0.22 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 2 Inspecting a ‘single group’ of observations using a Bayesian multilevel model | Bayesian multilevel models in R: A conceptual and practical introduction for linguists" />
  <meta property="og:type" content="book" />
  <meta property="og:url" content="http://santiagobarreda.com" />
  
  <meta property="og:description" content="Bayesian Models for Linguists" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 2 Inspecting a ‘single group’ of observations using a Bayesian multilevel model | Bayesian multilevel models in R: A conceptual and practical introduction for linguists" />
  
  <meta name="twitter:description" content="Bayesian Models for Linguists" />
  

<meta name="author" content="Santiago Bareda" />


<meta name="date" content="2021-07-14" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="inspecting-a-single-group-of-observations.html"/>
<link rel="next" href="comparing-two-groups-of-observations.html"/>
<script src="libs/header-attrs-2.9/header-attrs.js"></script>
<script src="libs/jquery-3.5.1/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>
<script src="libs/htmlwidgets-1.5.3/htmlwidgets.js"></script>
<script src="libs/plotly-binding-4.9.4.1/plotly.js"></script>
<script src="libs/typedarray-0.1/typedarray.min.js"></script>
<link href="libs/crosstalk-1.1.1/css/crosstalk.css" rel="stylesheet" />
<script src="libs/crosstalk-1.1.1/js/crosstalk.min.js"></script>
<link href="libs/plotly-htmlwidgets-css-1.57.1/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="libs/plotly-main-1.57.1/plotly-latest.min.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Bayesian Models for Linguists</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Introduction</a></li>
<li class="chapter" data-level="1" data-path="inspecting-a-single-group-of-observations.html"><a href="inspecting-a-single-group-of-observations.html"><i class="fa fa-check"></i><b>1</b> Inspecting a single group of observations</a>
<ul>
<li class="chapter" data-level="1.1" data-path="inspecting-a-single-group-of-observations.html"><a href="inspecting-a-single-group-of-observations.html#data-and-research-questions"><i class="fa fa-check"></i><b>1.1</b> Data and research questions</a>
<ul>
<li class="chapter" data-level="1.1.1" data-path="inspecting-a-single-group-of-observations.html"><a href="inspecting-a-single-group-of-observations.html#inspecting-the-central-location-and-spread-of-values"><i class="fa fa-check"></i><b>1.1.1</b> Inspecting the central location and spread of values</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="inspecting-a-single-group-of-observations.html"><a href="inspecting-a-single-group-of-observations.html#probability-distributions"><i class="fa fa-check"></i><b>1.2</b> Probability Distributions</a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="inspecting-a-single-group-of-observations.html"><a href="inspecting-a-single-group-of-observations.html#the-normal-distribution"><i class="fa fa-check"></i><b>1.2.1</b> The normal distribution</a></li>
<li class="chapter" data-level="1.2.2" data-path="inspecting-a-single-group-of-observations.html"><a href="inspecting-a-single-group-of-observations.html#referring-to-the-normal-distribution-to-make-inferences"><i class="fa fa-check"></i><b>1.2.2</b> Referring to the normal distribution to make inferences</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="inspecting-a-single-group-of-observations.html"><a href="inspecting-a-single-group-of-observations.html#probabilities-of-events-and-likelihoods-of-parameters"><i class="fa fa-check"></i><b>1.3</b> Probabilities of events and likelihoods of parameters</a>
<ul>
<li class="chapter" data-level="1.3.1" data-path="inspecting-a-single-group-of-observations.html"><a href="inspecting-a-single-group-of-observations.html#making-inferences-using-likelihoods"><i class="fa fa-check"></i><b>1.3.1</b> Making inferences using likelihoods</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="inspecting-a-single-group-of-observations.html"><a href="inspecting-a-single-group-of-observations.html#bayesian-models"><i class="fa fa-check"></i><b>1.4</b> Bayesian models</a>
<ul>
<li class="chapter" data-level="1.4.1" data-path="inspecting-a-single-group-of-observations.html"><a href="inspecting-a-single-group-of-observations.html#what-are-regression-models"><i class="fa fa-check"></i><b>1.4.1</b> What are regression models?</a></li>
<li class="chapter" data-level="1.4.2" data-path="inspecting-a-single-group-of-observations.html"><a href="inspecting-a-single-group-of-observations.html#whats-bayesian-about-these-models"><i class="fa fa-check"></i><b>1.4.2</b> What’s ‘Bayesian’ about these models?</a></li>
</ul></li>
<li class="chapter" data-level="1.5" data-path="inspecting-a-single-group-of-observations.html"><a href="inspecting-a-single-group-of-observations.html#posterior-distributions"><i class="fa fa-check"></i><b>1.5</b> Posterior distributions</a>
<ul>
<li class="chapter" data-level="1.5.1" data-path="inspecting-a-single-group-of-observations.html"><a href="inspecting-a-single-group-of-observations.html#sampling-from-the-posterior"><i class="fa fa-check"></i><b>1.5.1</b> Sampling from the posterior</a></li>
</ul></li>
<li class="chapter" data-level="1.6" data-path="inspecting-a-single-group-of-observations.html"><a href="inspecting-a-single-group-of-observations.html#exercises"><i class="fa fa-check"></i><b>1.6</b> Exercises</a></li>
<li class="chapter" data-level="1.7" data-path="inspecting-a-single-group-of-observations.html"><a href="inspecting-a-single-group-of-observations.html#plot-code"><i class="fa fa-check"></i><b>1.7</b> Plot Code</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html"><i class="fa fa-check"></i><b>2</b> Inspecting a ‘single group’ of observations using a Bayesian multilevel model</a>
<ul>
<li class="chapter" data-level="2.1" data-path="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#data-and-research-questions-1"><i class="fa fa-check"></i><b>2.1</b> Data and research questions</a></li>
<li class="chapter" data-level="2.2" data-path="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#estimating-a-single-mean-with-the-brms-package"><i class="fa fa-check"></i><b>2.2</b> Estimating a single mean with the <code>brms</code> package</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#description-of-the-model"><i class="fa fa-check"></i><b>2.2.1</b> Description of the model</a></li>
<li class="chapter" data-level="2.2.2" data-path="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#the-model-formula"><i class="fa fa-check"></i><b>2.2.2</b> The model formula</a></li>
<li class="chapter" data-level="2.2.3" data-path="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#fitting-the-model-calling-the-brm-function"><i class="fa fa-check"></i><b>2.2.3</b> Fitting the model: Calling the <code>brm</code> function</a></li>
<li class="chapter" data-level="2.2.4" data-path="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#interpreting-the-model-the-print-statement"><i class="fa fa-check"></i><b>2.2.4</b> Interpreting the model: the print statement</a></li>
<li class="chapter" data-level="2.2.5" data-path="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#seeing-the-samples"><i class="fa fa-check"></i><b>2.2.5</b> Seeing the samples</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#repeated-measures-data"><i class="fa fa-check"></i><b>2.3</b> Repeated measures data</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#multilevel-models"><i class="fa fa-check"></i><b>2.3.1</b> Multilevel models</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#estimating-a-multilevel-model-with-brms"><i class="fa fa-check"></i><b>2.4</b> Estimating a multilevel model with <code>brms</code></a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#description-of-the-model-1"><i class="fa fa-check"></i><b>2.4.1</b> Description of the model</a></li>
<li class="chapter" data-level="2.4.2" data-path="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#fitting-the-model"><i class="fa fa-check"></i><b>2.4.2</b> Fitting the model</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#checking-model-convergence"><i class="fa fa-check"></i><b>2.5</b> Checking model convergence</a></li>
<li class="chapter" data-level="2.6" data-path="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#specifying-prior-probabilities"><i class="fa fa-check"></i><b>2.6</b> Specifying prior probabilities</a></li>
<li class="chapter" data-level="2.7" data-path="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#answering-our-research-questions"><i class="fa fa-check"></i><b>2.7</b> Answering our research questions</a></li>
<li class="chapter" data-level="2.8" data-path="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#simulating-data-using-our-model-parameters"><i class="fa fa-check"></i><b>2.8</b> Simulating data using our model parameters</a></li>
<li class="chapter" data-level="2.9" data-path="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#frequentist-corner"><i class="fa fa-check"></i><b>2.9</b> Frequentist corner</a>
<ul>
<li class="chapter" data-level="2.9.1" data-path="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#bayesian-multilevel-modesl-vs.-lmer"><i class="fa fa-check"></i><b>2.9.1</b> Bayesian multilevel modesl vs. lmer</a></li>
<li class="chapter" data-level="2.9.2" data-path="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#bayesian-multilevel-modesl-vs.-the-one-sample-t-test"><i class="fa fa-check"></i><b>2.9.2</b> Bayesian multilevel modesl vs. the one-sample t-test</a></li>
</ul></li>
<li class="chapter" data-level="2.10" data-path="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#exercises-1"><i class="fa fa-check"></i><b>2.10</b> Exercises</a></li>
<li class="chapter" data-level="2.11" data-path="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#plot-code-1"><i class="fa fa-check"></i><b>2.11</b> Plot Code</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="comparing-two-groups-of-observations.html"><a href="comparing-two-groups-of-observations.html"><i class="fa fa-check"></i><b>3</b> Comparing two groups of observations</a>
<ul>
<li class="chapter" data-level="3.1" data-path="comparing-two-groups-of-observations.html"><a href="comparing-two-groups-of-observations.html#data-and-research-questions-2"><i class="fa fa-check"></i><b>3.1</b> Data and research questions</a></li>
<li class="chapter" data-level="3.2" data-path="comparing-two-groups-of-observations.html"><a href="comparing-two-groups-of-observations.html#estimating-the-difference-between-two-means-with-brms"><i class="fa fa-check"></i><b>3.2</b> Estimating the difference between two means with ‘brms’</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="comparing-two-groups-of-observations.html"><a href="comparing-two-groups-of-observations.html#fitting-the-model-1"><i class="fa fa-check"></i><b>3.2.1</b> Fitting the model</a></li>
<li class="chapter" data-level="3.2.2" data-path="comparing-two-groups-of-observations.html"><a href="comparing-two-groups-of-observations.html#interpreting-the-model"><i class="fa fa-check"></i><b>3.2.2</b> Interpreting the model</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="comparing-two-groups-of-observations.html"><a href="comparing-two-groups-of-observations.html#contrasts"><i class="fa fa-check"></i><b>3.3</b> Contrasts</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="comparing-two-groups-of-observations.html"><a href="comparing-two-groups-of-observations.html#treatment-coding"><i class="fa fa-check"></i><b>3.3.1</b> Treatment coding</a></li>
<li class="chapter" data-level="3.3.2" data-path="comparing-two-groups-of-observations.html"><a href="comparing-two-groups-of-observations.html#sum-coding"><i class="fa fa-check"></i><b>3.3.2</b> Sum coding</a></li>
<li class="chapter" data-level="3.3.3" data-path="comparing-two-groups-of-observations.html"><a href="comparing-two-groups-of-observations.html#comparison-of-sum-and-treatment-coding"><i class="fa fa-check"></i><b>3.3.3</b> Comparison of sum and treatment coding</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="comparing-two-groups-of-observations.html"><a href="comparing-two-groups-of-observations.html#refitting-the-model-with-sum-coding"><i class="fa fa-check"></i><b>3.4</b> Refitting the model with sum coding</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="comparing-two-groups-of-observations.html"><a href="comparing-two-groups-of-observations.html#fitting-the-model-2"><i class="fa fa-check"></i><b>3.4.1</b> Fitting the model</a></li>
<li class="chapter" data-level="3.4.2" data-path="comparing-two-groups-of-observations.html"><a href="comparing-two-groups-of-observations.html#description-of-the-model-2"><i class="fa fa-check"></i><b>3.4.2</b> Description of the model</a></li>
<li class="chapter" data-level="3.4.3" data-path="comparing-two-groups-of-observations.html"><a href="comparing-two-groups-of-observations.html#interpreting-the-model-1"><i class="fa fa-check"></i><b>3.4.3</b> Interpreting the model</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="comparing-two-groups-of-observations.html"><a href="comparing-two-groups-of-observations.html#random-effects"><i class="fa fa-check"></i><b>3.5</b> ‘Random’ Effects</a>
<ul>
<li class="chapter" data-level="3.5.1" data-path="comparing-two-groups-of-observations.html"><a href="comparing-two-groups-of-observations.html#random-effects-priors-and-pooling"><i class="fa fa-check"></i><b>3.5.1</b> Random effects, priors and pooling</a></li>
<li class="chapter" data-level="3.5.2" data-path="comparing-two-groups-of-observations.html"><a href="comparing-two-groups-of-observations.html#inspecting-the-random-effects"><i class="fa fa-check"></i><b>3.5.2</b> Inspecting the random effects</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="comparing-two-groups-of-observations.html"><a href="comparing-two-groups-of-observations.html#but-what-does-it-all-mean"><i class="fa fa-check"></i><b>3.6</b> But what does it all mean?</a></li>
<li class="chapter" data-level="3.7" data-path="comparing-two-groups-of-observations.html"><a href="comparing-two-groups-of-observations.html#simulating-the-two-group-model"><i class="fa fa-check"></i><b>3.7</b> Simulating the two-group model</a></li>
<li class="chapter" data-level="3.8" data-path="comparing-two-groups-of-observations.html"><a href="comparing-two-groups-of-observations.html#frequentist-corner-1"><i class="fa fa-check"></i><b>3.8</b> Frequentist corner</a></li>
<li class="chapter" data-level="3.9" data-path="comparing-two-groups-of-observations.html"><a href="comparing-two-groups-of-observations.html#lmer-corner"><i class="fa fa-check"></i><b>3.9</b> Lmer corner</a></li>
<li class="chapter" data-level="3.10" data-path="comparing-two-groups-of-observations.html"><a href="comparing-two-groups-of-observations.html#exercises-2"><i class="fa fa-check"></i><b>3.10</b> Exercises</a></li>
<li class="chapter" data-level="3.11" data-path="comparing-two-groups-of-observations.html"><a href="comparing-two-groups-of-observations.html#plot-code-2"><i class="fa fa-check"></i><b>3.11</b> Plot Code</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="comparing-many-groups.html"><a href="comparing-many-groups.html"><i class="fa fa-check"></i><b>4</b> Comparing many groups</a>
<ul>
<li class="chapter" data-level="4.1" data-path="comparing-many-groups.html"><a href="comparing-many-groups.html#data-and-research-questions-3"><i class="fa fa-check"></i><b>4.1</b> Data and research questions</a></li>
<li class="chapter" data-level="4.2" data-path="comparing-many-groups.html"><a href="comparing-many-groups.html#comparing-four-or-any-number-of-groups"><i class="fa fa-check"></i><b>4.2</b> Comparing four (or any number of) groups</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="comparing-many-groups.html"><a href="comparing-many-groups.html#the-model"><i class="fa fa-check"></i><b>4.2.1</b> The model</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="comparing-many-groups.html"><a href="comparing-many-groups.html#investigating-many-groups-using-predictors-analysis-of-variance"><i class="fa fa-check"></i><b>4.3</b> Investigating many groups using predictors: Analysis of Variance</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="comparing-many-groups.html"><a href="comparing-many-groups.html#description-of-the-model-3"><i class="fa fa-check"></i><b>4.3.1</b> Description of the model</a></li>
<li class="chapter" data-level="4.3.2" data-path="comparing-many-groups.html"><a href="comparing-many-groups.html#fitting-the-model-and-interpreting-the-results"><i class="fa fa-check"></i><b>4.3.2</b> Fitting the model and interpreting the results</a></li>
<li class="chapter" data-level="4.3.3" data-path="comparing-many-groups.html"><a href="comparing-many-groups.html#investigating-model-fit"><i class="fa fa-check"></i><b>4.3.3</b> Investigating model fit</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="comparing-many-groups.html"><a href="comparing-many-groups.html#interactions-and-interaction-plots"><i class="fa fa-check"></i><b>4.4</b> Interactions and interaction plots</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="comparing-many-groups.html"><a href="comparing-many-groups.html#interactions-in-our-f0-data"><i class="fa fa-check"></i><b>4.4.1</b> Interactions in our f0 data</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="comparing-many-groups.html"><a href="comparing-many-groups.html#investigating-interactions-with-a-model"><i class="fa fa-check"></i><b>4.5</b> Investigating interactions with a model</a>
<ul>
<li class="chapter" data-level="4.5.1" data-path="comparing-many-groups.html"><a href="comparing-many-groups.html#fitting-the-model-and-interpreting-the-results-1"><i class="fa fa-check"></i><b>4.5.1</b> Fitting the model and interpreting the results</a></li>
<li class="chapter" data-level="4.5.2" data-path="comparing-many-groups.html"><a href="comparing-many-groups.html#assessing-model-fit"><i class="fa fa-check"></i><b>4.5.2</b> Assessing model fit</a></li>
<li class="chapter" data-level="4.5.3" data-path="comparing-many-groups.html"><a href="comparing-many-groups.html#investigating-the-interactions-the-easy-way"><i class="fa fa-check"></i><b>4.5.3</b> Investigating the interactions the easy way</a></li>
<li class="chapter" data-level="4.5.4" data-path="comparing-many-groups.html"><a href="comparing-many-groups.html#making-plots"><i class="fa fa-check"></i><b>4.5.4</b> Making plots</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="comparing-many-groups.html"><a href="comparing-many-groups.html#lmer-corner-1"><i class="fa fa-check"></i><b>4.6</b> Lmer corner</a></li>
<li class="chapter" data-level="4.7" data-path="comparing-many-groups.html"><a href="comparing-many-groups.html#exercises-3"><i class="fa fa-check"></i><b>4.7</b> Exercises</a></li>
<li class="chapter" data-level="4.8" data-path="comparing-many-groups.html"><a href="comparing-many-groups.html#plot-code-3"><i class="fa fa-check"></i><b>4.8</b> Plot Code</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="including-continuous-predictors-in-our-model.html"><a href="including-continuous-predictors-in-our-model.html"><i class="fa fa-check"></i><b>5</b> Including continuous predictors in our model</a>
<ul>
<li class="chapter" data-level="5.1" data-path="including-continuous-predictors-in-our-model.html"><a href="including-continuous-predictors-in-our-model.html#data-and-research-questions-4"><i class="fa fa-check"></i><b>5.1</b> Data and research questions</a></li>
<li class="chapter" data-level="5.2" data-path="including-continuous-predictors-in-our-model.html"><a href="including-continuous-predictors-in-our-model.html#continuous-predictors-modeling-variation-along-lines"><i class="fa fa-check"></i><b>5.2</b> Continuous predictors: modeling variation along lines</a></li>
<li class="chapter" data-level="5.3" data-path="including-continuous-predictors-in-our-model.html"><a href="including-continuous-predictors-in-our-model.html#models-with-a-single-slope-and-intercept"><i class="fa fa-check"></i><b>5.3</b> Models with a single slope and intercept</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="including-continuous-predictors-in-our-model.html"><a href="including-continuous-predictors-in-our-model.html#description-of-the-model-4"><i class="fa fa-check"></i><b>5.3.1</b> Description of the model</a></li>
<li class="chapter" data-level="5.3.2" data-path="including-continuous-predictors-in-our-model.html"><a href="including-continuous-predictors-in-our-model.html#fitting-the-model-3"><i class="fa fa-check"></i><b>5.3.2</b> Fitting the model</a></li>
<li class="chapter" data-level="5.3.3" data-path="including-continuous-predictors-in-our-model.html"><a href="including-continuous-predictors-in-our-model.html#interpreting-the-model-2"><i class="fa fa-check"></i><b>5.3.3</b> Interpreting the model</a></li>
<li class="chapter" data-level="5.3.4" data-path="including-continuous-predictors-in-our-model.html"><a href="including-continuous-predictors-in-our-model.html#centering-predictors"><i class="fa fa-check"></i><b>5.3.4</b> Centering predictors</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="including-continuous-predictors-in-our-model.html"><a href="including-continuous-predictors-in-our-model.html#interactions-in-our-line-parameters"><i class="fa fa-check"></i><b>5.4</b> Interactions in our line parameters</a></li>
<li class="chapter" data-level="5.5" data-path="including-continuous-predictors-in-our-model.html"><a href="including-continuous-predictors-in-our-model.html#models-with-group-dependent-intercepts-but-shared-slopes"><i class="fa fa-check"></i><b>5.5</b> Models with group-dependent intercepts, but shared slopes</a>
<ul>
<li class="chapter" data-level="5.5.1" data-path="including-continuous-predictors-in-our-model.html"><a href="including-continuous-predictors-in-our-model.html#description-of-the-model-5"><i class="fa fa-check"></i><b>5.5.1</b> Description of the model</a></li>
<li class="chapter" data-level="5.5.2" data-path="including-continuous-predictors-in-our-model.html"><a href="including-continuous-predictors-in-our-model.html#fitting-the-model-4"><i class="fa fa-check"></i><b>5.5.2</b> Fitting the model</a></li>
<li class="chapter" data-level="5.5.3" data-path="including-continuous-predictors-in-our-model.html"><a href="including-continuous-predictors-in-our-model.html#the-effect-of-including-a-slope"><i class="fa fa-check"></i><b>5.5.3</b> The effect of including a slope</a></li>
<li class="chapter" data-level="5.5.4" data-path="including-continuous-predictors-in-our-model.html"><a href="including-continuous-predictors-in-our-model.html#interpreting-group-effects-in-the-presence-of-a-continuous-predictor"><i class="fa fa-check"></i><b>5.5.4</b> Interpreting group effects in the presence of a continuous predictor</a></li>
</ul></li>
<li class="chapter" data-level="5.6" data-path="including-continuous-predictors-in-our-model.html"><a href="including-continuous-predictors-in-our-model.html#models-with-group-dependent-slopes-and-intercepts"><i class="fa fa-check"></i><b>5.6</b> Models with group-dependent slopes and intercepts</a>
<ul>
<li class="chapter" data-level="5.6.1" data-path="including-continuous-predictors-in-our-model.html"><a href="including-continuous-predictors-in-our-model.html#description-of-the-model-6"><i class="fa fa-check"></i><b>5.6.1</b> Description of the model</a></li>
<li class="chapter" data-level="5.6.2" data-path="including-continuous-predictors-in-our-model.html"><a href="including-continuous-predictors-in-our-model.html#fitting-the-model-5"><i class="fa fa-check"></i><b>5.6.2</b> Fitting the model</a></li>
<li class="chapter" data-level="5.6.3" data-path="including-continuous-predictors-in-our-model.html"><a href="including-continuous-predictors-in-our-model.html#interpreting-the-model-3"><i class="fa fa-check"></i><b>5.6.3</b> Interpreting the model</a></li>
</ul></li>
<li class="chapter" data-level="5.7" data-path="including-continuous-predictors-in-our-model.html"><a href="including-continuous-predictors-in-our-model.html#exercises-4"><i class="fa fa-check"></i><b>5.7</b> Exercises</a></li>
<li class="chapter" data-level="5.8" data-path="including-continuous-predictors-in-our-model.html"><a href="including-continuous-predictors-in-our-model.html#plot-code-4"><i class="fa fa-check"></i><b>5.8</b> Plot Code</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="random-slopes.html"><a href="random-slopes.html"><i class="fa fa-check"></i><b>6</b> Random slopes</a>
<ul>
<li class="chapter" data-level="6.1" data-path="random-slopes.html"><a href="random-slopes.html#data-and-research-questions-5"><i class="fa fa-check"></i><b>6.1</b> Data and research questions</a></li>
<li class="chapter" data-level="6.2" data-path="random-slopes.html"><a href="random-slopes.html#repeated-measures-and-speaker-dependent-parameter-values"><i class="fa fa-check"></i><b>6.2</b> Repeated measures and speaker-dependent parameter values</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="random-slopes.html"><a href="random-slopes.html#description-of-the-model-7"><i class="fa fa-check"></i><b>6.2.1</b> Description of the model</a></li>
<li class="chapter" data-level="6.2.2" data-path="random-slopes.html"><a href="random-slopes.html#fitting-the-model-6"><i class="fa fa-check"></i><b>6.2.2</b> Fitting the model</a></li>
<li class="chapter" data-level="6.2.3" data-path="random-slopes.html"><a href="random-slopes.html#interpreting-the-model-4"><i class="fa fa-check"></i><b>6.2.3</b> Interpreting the model</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="random-slopes.html"><a href="random-slopes.html#random-effects-and-the-multivariate-normal-distribution"><i class="fa fa-check"></i><b>6.3</b> Random effects and the multivariate normal distribution</a></li>
<li class="chapter" data-level="6.4" data-path="random-slopes.html"><a href="random-slopes.html#random-slopes-1"><i class="fa fa-check"></i><b>6.4</b> Random slopes</a>
<ul>
<li class="chapter" data-level="6.4.1" data-path="random-slopes.html"><a href="random-slopes.html#description-of-the-model-8"><i class="fa fa-check"></i><b>6.4.1</b> Description of the model</a></li>
<li class="chapter" data-level="6.4.2" data-path="random-slopes.html"><a href="random-slopes.html#fitting-the-model-7"><i class="fa fa-check"></i><b>6.4.2</b> Fitting the model</a></li>
<li class="chapter" data-level="6.4.3" data-path="random-slopes.html"><a href="random-slopes.html#interpreting-the-model-5"><i class="fa fa-check"></i><b>6.4.3</b> Interpreting the model</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="random-slopes.html"><a href="random-slopes.html#more-predictors-and-more-random-slopes"><i class="fa fa-check"></i><b>6.5</b> More predictors and more random slopes</a>
<ul>
<li class="chapter" data-level="6.5.1" data-path="random-slopes.html"><a href="random-slopes.html#adding-another-random-slope"><i class="fa fa-check"></i><b>6.5.1</b> Adding another random slope</a></li>
<li class="chapter" data-level="6.5.2" data-path="random-slopes.html"><a href="random-slopes.html#adding-random-factors"><i class="fa fa-check"></i><b>6.5.2</b> Adding random factors</a></li>
<li class="chapter" data-level="6.5.3" data-path="random-slopes.html"><a href="random-slopes.html#the-independence-of-continuous-predictors"><i class="fa fa-check"></i><b>6.5.3</b> The independence of continuous predictors</a></li>
</ul></li>
<li class="chapter" data-level="6.6" data-path="random-slopes.html"><a href="random-slopes.html#answering-our-research-questions-1"><i class="fa fa-check"></i><b>6.6</b> Answering our research questions</a></li>
<li class="chapter" data-level="6.7" data-path="random-slopes.html"><a href="random-slopes.html#lmer-corner-2"><i class="fa fa-check"></i><b>6.7</b> Lmer corner</a></li>
<li class="chapter" data-level="6.8" data-path="random-slopes.html"><a href="random-slopes.html#exercises-5"><i class="fa fa-check"></i><b>6.8</b> Exercises</a></li>
<li class="chapter" data-level="6.9" data-path="random-slopes.html"><a href="random-slopes.html#plot-code-5"><i class="fa fa-check"></i><b>6.9</b> Plot Code</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="logistic-regression.html"><a href="logistic-regression.html"><i class="fa fa-check"></i><b>7</b> Logistic regression</a>
<ul>
<li class="chapter" data-level="7.1" data-path="logistic-regression.html"><a href="logistic-regression.html#data-and-research-questions-6"><i class="fa fa-check"></i><b>7.1</b> Data and research questions</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="logistic-regression.html"><a href="logistic-regression.html#dichotomous-variables-and-data"><i class="fa fa-check"></i><b>7.1.1</b> Dichotomous variables and data</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="logistic-regression.html"><a href="logistic-regression.html#generalizing-our-linear-models"><i class="fa fa-check"></i><b>7.2</b> Generalizing our linear models</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="logistic-regression.html"><a href="logistic-regression.html#link-functions"><i class="fa fa-check"></i><b>7.2.1</b> Link functions</a></li>
<li class="chapter" data-level="7.2.2" data-path="logistic-regression.html"><a href="logistic-regression.html#logits"><i class="fa fa-check"></i><b>7.2.2</b> Logits</a></li>
<li class="chapter" data-level="7.2.3" data-path="logistic-regression.html"><a href="logistic-regression.html#the-logistic-link-function"><i class="fa fa-check"></i><b>7.2.3</b> The logistic link function</a></li>
<li class="chapter" data-level="7.2.4" data-path="logistic-regression.html"><a href="logistic-regression.html#building-intuitions-about-logits"><i class="fa fa-check"></i><b>7.2.4</b> Building intuitions about logits</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="logistic-regression.html"><a href="logistic-regression.html#logistic-regression-with-one-predictor"><i class="fa fa-check"></i><b>7.3</b> Logistic regression with one predictor</a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="logistic-regression.html"><a href="logistic-regression.html#description-of-the-model-9"><i class="fa fa-check"></i><b>7.3.1</b> Description of the model</a></li>
<li class="chapter" data-level="7.3.2" data-path="logistic-regression.html"><a href="logistic-regression.html#fitting-the-model-8"><i class="fa fa-check"></i><b>7.3.2</b> Fitting the model</a></li>
<li class="chapter" data-level="7.3.3" data-path="logistic-regression.html"><a href="logistic-regression.html#interpreting-the-model-6"><i class="fa fa-check"></i><b>7.3.3</b> Interpreting the model</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="logistic-regression.html"><a href="logistic-regression.html#answering-our-research-question"><i class="fa fa-check"></i><b>7.4</b> Answering our research question</a></li>
<li class="chapter" data-level="7.5" data-path="logistic-regression.html"><a href="logistic-regression.html#plot-code-6"><i class="fa fa-check"></i><b>7.5</b> Plot Code</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="bayesian-anova-and-interpreting-complicated-models.html"><a href="bayesian-anova-and-interpreting-complicated-models.html"><i class="fa fa-check"></i><b>8</b> Bayesian ANOVA and interpreting complicated models</a>
<ul>
<li class="chapter" data-level="8.1" data-path="bayesian-anova-and-interpreting-complicated-models.html"><a href="bayesian-anova-and-interpreting-complicated-models.html#data-and-research-questions-7"><i class="fa fa-check"></i><b>8.1</b> Data and research questions</a>
<ul>
<li class="chapter" data-level="8.1.1" data-path="bayesian-anova-and-interpreting-complicated-models.html"><a href="bayesian-anova-and-interpreting-complicated-models.html#the-experiment"><i class="fa fa-check"></i><b>8.1.1</b> The experiment</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="bayesian-anova-and-interpreting-complicated-models.html"><a href="bayesian-anova-and-interpreting-complicated-models.html#deciding-on-a-model"><i class="fa fa-check"></i><b>8.2</b> Deciding on a model</a></li>
<li class="chapter" data-level="8.3" data-path="bayesian-anova-and-interpreting-complicated-models.html"><a href="bayesian-anova-and-interpreting-complicated-models.html#fitting-the-models"><i class="fa fa-check"></i><b>8.3</b> Fitting the models</a>
<ul>
<li class="chapter" data-level="8.3.1" data-path="bayesian-anova-and-interpreting-complicated-models.html"><a href="bayesian-anova-and-interpreting-complicated-models.html#the-maximal-models"><i class="fa fa-check"></i><b>8.3.1</b> The ‘maximal’ models</a></li>
<li class="chapter" data-level="8.3.2" data-path="bayesian-anova-and-interpreting-complicated-models.html"><a href="bayesian-anova-and-interpreting-complicated-models.html#fitting-the-final-models-in-lmer-and-brms"><i class="fa fa-check"></i><b>8.3.2</b> Fitting the ‘final’ models in lmer and brms</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="bayesian-anova-and-interpreting-complicated-models.html"><a href="bayesian-anova-and-interpreting-complicated-models.html#comparing-the-maximal-and-final-models"><i class="fa fa-check"></i><b>8.4</b> Comparing the maximal and final models</a></li>
<li class="chapter" data-level="8.5" data-path="bayesian-anova-and-interpreting-complicated-models.html"><a href="bayesian-anova-and-interpreting-complicated-models.html#bayesian-analysis-of-variance"><i class="fa fa-check"></i><b>8.5</b> Bayesian Analysis of Variance</a>
<ul>
<li class="chapter" data-level="8.5.1" data-path="bayesian-anova-and-interpreting-complicated-models.html"><a href="bayesian-anova-and-interpreting-complicated-models.html#getting-the-superpopulation-standard-deviations-from-our-models"><i class="fa fa-check"></i><b>8.5.1</b> Getting the superpopulation standard deviations from our models</a></li>
<li class="chapter" data-level="8.5.2" data-path="bayesian-anova-and-interpreting-complicated-models.html"><a href="bayesian-anova-and-interpreting-complicated-models.html#getting-the-finite-population-standard-deviations-from-our-models"><i class="fa fa-check"></i><b>8.5.2</b> Getting the finite-population standard deviations from our models</a></li>
<li class="chapter" data-level="8.5.3" data-path="bayesian-anova-and-interpreting-complicated-models.html"><a href="bayesian-anova-and-interpreting-complicated-models.html#using-the-banova-function"><i class="fa fa-check"></i><b>8.5.3</b> Using the <code>banova</code> function</a></li>
<li class="chapter" data-level="8.5.4" data-path="bayesian-anova-and-interpreting-complicated-models.html"><a href="bayesian-anova-and-interpreting-complicated-models.html#applying-the-banova-function-to-our-gender-perception-model"><i class="fa fa-check"></i><b>8.5.4</b> Applying the <code>banova</code> function to our gender perception model</a></li>
</ul></li>
<li class="chapter" data-level="8.6" data-path="bayesian-anova-and-interpreting-complicated-models.html"><a href="bayesian-anova-and-interpreting-complicated-models.html#applying-a-bayesian-anova-to-a-more-complicated-model"><i class="fa fa-check"></i><b>8.6</b> Applying a Bayesian ANOVA to a more-complicated model</a>
<ul>
<li class="chapter" data-level="8.6.1" data-path="bayesian-anova-and-interpreting-complicated-models.html"><a href="bayesian-anova-and-interpreting-complicated-models.html#description-of-the-model-10"><i class="fa fa-check"></i><b>8.6.1</b> Description of the model</a></li>
<li class="chapter" data-level="8.6.2" data-path="bayesian-anova-and-interpreting-complicated-models.html"><a href="bayesian-anova-and-interpreting-complicated-models.html#fitting-the-model-9"><i class="fa fa-check"></i><b>8.6.2</b> Fitting the model</a></li>
<li class="chapter" data-level="8.6.3" data-path="bayesian-anova-and-interpreting-complicated-models.html"><a href="bayesian-anova-and-interpreting-complicated-models.html#interpreting-the-model-7"><i class="fa fa-check"></i><b>8.6.3</b> Interpreting the model</a></li>
</ul></li>
<li class="chapter" data-level="8.7" data-path="bayesian-anova-and-interpreting-complicated-models.html"><a href="bayesian-anova-and-interpreting-complicated-models.html#plot-code-7"><i class="fa fa-check"></i><b>8.7</b> Plot Code</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="multivariate-models-predictive-accuracy-and-handling-outliers.html"><a href="multivariate-models-predictive-accuracy-and-handling-outliers.html"><i class="fa fa-check"></i><b>9</b> Multivariate models, predictive accuracy, and handling outliers</a>
<ul>
<li class="chapter" data-level="9.1" data-path="multivariate-models-predictive-accuracy-and-handling-outliers.html"><a href="multivariate-models-predictive-accuracy-and-handling-outliers.html#data-and-research-questions-8"><i class="fa fa-check"></i><b>9.1</b> Data and research questions</a></li>
<li class="chapter" data-level="9.2" data-path="multivariate-models-predictive-accuracy-and-handling-outliers.html"><a href="multivariate-models-predictive-accuracy-and-handling-outliers.html#using-multiple-continuous-predictors"><i class="fa fa-check"></i><b>9.2</b> Using multiple continuous predictors</a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="multivariate-models-predictive-accuracy-and-handling-outliers.html"><a href="multivariate-models-predictive-accuracy-and-handling-outliers.html#describing-and-fitting-the-model"><i class="fa fa-check"></i><b>9.2.1</b> Describing and fitting the model</a></li>
<li class="chapter" data-level="9.2.2" data-path="multivariate-models-predictive-accuracy-and-handling-outliers.html"><a href="multivariate-models-predictive-accuracy-and-handling-outliers.html#interpreting-the-model-8"><i class="fa fa-check"></i><b>9.2.2</b> Interpreting the model</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="multivariate-models-predictive-accuracy-and-handling-outliers.html"><a href="multivariate-models-predictive-accuracy-and-handling-outliers.html#considering-predictive-accuracy"><i class="fa fa-check"></i><b>9.3</b> Considering predictive accuracy</a></li>
<li class="chapter" data-level="9.4" data-path="multivariate-models-predictive-accuracy-and-handling-outliers.html"><a href="multivariate-models-predictive-accuracy-and-handling-outliers.html#handling-outliers-t-distributed-errors"><i class="fa fa-check"></i><b>9.4</b> Handling outliers: t-distributed errors</a>
<ul>
<li class="chapter" data-level="9.4.1" data-path="multivariate-models-predictive-accuracy-and-handling-outliers.html"><a href="multivariate-models-predictive-accuracy-and-handling-outliers.html#fitting-and-interpreting-the-model"><i class="fa fa-check"></i><b>9.4.1</b> Fitting and interpreting the model</a></li>
</ul></li>
<li class="chapter" data-level="9.5" data-path="multivariate-models-predictive-accuracy-and-handling-outliers.html"><a href="multivariate-models-predictive-accuracy-and-handling-outliers.html#plot-code-8"><i class="fa fa-check"></i><b>9.5</b> Plot Code</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="modeling-standard-deviations.html"><a href="modeling-standard-deviations.html"><i class="fa fa-check"></i><b>10</b> Modeling Standard Deviations</a>
<ul>
<li class="chapter" data-level="10.1" data-path="modeling-standard-deviations.html"><a href="modeling-standard-deviations.html#data"><i class="fa fa-check"></i><b>10.1</b> Data</a></li>
<li class="chapter" data-level="10.2" data-path="modeling-standard-deviations.html"><a href="modeling-standard-deviations.html#modeling-variation-in-the-error"><i class="fa fa-check"></i><b>10.2</b> Modeling variation in the error</a>
<ul>
<li class="chapter" data-level="10.2.1" data-path="modeling-standard-deviations.html"><a href="modeling-standard-deviations.html#fitting-and-interpreting-our-model"><i class="fa fa-check"></i><b>10.2.1</b> Fitting and interpreting our model</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="modeling-standard-deviations.html"><a href="modeling-standard-deviations.html#modeling-group-variation-in-our-random-effects"><i class="fa fa-check"></i><b>10.3</b> Modeling group variation in our random effects</a>
<ul>
<li class="chapter" data-level="10.3.1" data-path="modeling-standard-deviations.html"><a href="modeling-standard-deviations.html#fitting-and-interpreting-our-model-1"><i class="fa fa-check"></i><b>10.3.1</b> Fitting and interpreting our model</a></li>
<li class="chapter" data-level="10.3.2" data-path="modeling-standard-deviations.html"><a href="modeling-standard-deviations.html#two-dimensional-response-surfaces"><i class="fa fa-check"></i><b>10.3.2</b> Two-dimensional response surfaces</a></li>
</ul></li>
<li class="chapter" data-level="10.4" data-path="modeling-standard-deviations.html"><a href="modeling-standard-deviations.html#plot-code-9"><i class="fa fa-check"></i><b>10.4</b> Plot Code</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="http://www.santiagobarreda.com" target="blank">Written by Santiago Barreda</a></li>
<li><a href="A-Quick-Introduction-to-Multilevel-Bayesian-Models-for-Linguistic-Researchers.pdf" target="blank">Download possibly outdated and badly-formatted PDF</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Bayesian multilevel models in R: A conceptual and practical introduction for linguists</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model" class="section level1" number="2">
<h1><span class="header-section-number">Chapter 2</span> Inspecting a ‘single group’ of observations using a Bayesian multilevel model</h1>
<p>The previous chapter was mostly introductory, it introduced some basic terminology and concepts that are required to begin talking about models. In this chapter we are going to return to questions like ’what is the average value of <span class="math inline">\(x\)</span>, however, in this chapter we are going to learn to answer these questions using Bayesian multilevel regression models in R using the <code>brms</code> package.</p>
<p>The models discussed in this chapter can be used for data that comes from a single group of subjects. By a ‘single’ group I just mean that you are not trying to compare things here, you are just trying to understand the average values of some variable for a single group of observations. The data:</p>
<ul>
<li>comes from from one speaker/subject or many speakers/subjects.</li>
<li>each speaker/subject can contribute multiple data points, and the number does not need to be balanced across subjects.</li>
</ul>
<p>The ‘traditional’ design equivalent to these models is a one-sample t-test, although the Bayesian approach has many advantages (as discussed at the end of the chapter).</p>
<div id="data-and-research-questions-1" class="section level2" number="2.1">
<h2><span class="header-section-number">2.1</span> Data and research questions</h2>
<p>We’re going to keep analyzing the female f0 data from the Hillenbrand et al. (1995) dataset, discussed in chapter 1. These are 576 observations, 12 production collected from each of 48 women in the sample. So, our data comes from multiple speakers and we has multiple observations from each speaker, and the women are in the single group “adult women form Michigan”. Of course, we could divide these women into any number of smaller groups based on hair color, handedness, and so on. These women are considered to be in a single group because our model, our <em>conceptualization</em> of these speakers, places them in a single group.</p>
<p>We’re going to try to address the same questions we talked about last week:</p>
<ol style="list-style-type: decimal">
<li><p>What is the average f0 of the whole <em>population</em> likely to be?</p></li>
<li><p>Can we set bounds on likely mean f0 values based on the data we collected?</p></li>
</ol>
<p>However, this time we are going to do this with a Bayesian multilevel model. We’re going to see how the model provides us with the same information we got in the last chapter, in addition to providing us with additional useful information.</p>
</div>
<div id="estimating-a-single-mean-with-the-brms-package" class="section level2" number="2.2">
<h2><span class="header-section-number">2.2</span> Estimating a single mean with the <code>brms</code> package</h2>
<p>The <code>brms</code> <a href="https://github.com/paul-buerkner/brms">(‘Bayesian regression models’)</a> package in R lets you fit Bayesian models using the STAN probabilistic programming language using R. The package is really amazing and makes Bayesian multilevel modeling easy and accessible for anyone. It also includes a lot of helper functions that make working with these models very convenient.</p>
<p><code>brms</code> should be installed in R so that the models described below will work. Make sure you have the latest version of R (and Rstudio) and the latest version of the <code>brms</code> package installed. Sometimes using older versions can cause R to crash when fitting models. Anecdotal experience suggests that if all of the sudden trying to fit these models causes crashes or mysterious errors, its time to update one or more of R, Rstudio, or <code>brms</code>.</p>
<div id="description-of-the-model" class="section level3" number="2.2.1">
<h3><span class="header-section-number">2.2.1</span> Description of the model</h3>
<p>We’re going to learn to read and write formal descriptions of our models. The notation we will learn will help us describe our models efficiently, and it will help us understand the models used by other people.</p>
<p>The relationship between statistical concepts and the formal notation used to represent them is very similar to musical notation and the ability to play music. Someone who can play a song undoubtedly <em>knows</em> that song. However, in the absence of formal musical training that same person might not recognize sheet music recognizing the song. The person would also lack the vocabulary to discuss components of the song, and may find it difficult to learn to play new pieces. In the same way, most people have excellent intuitive understanding of many statistical concepts such as slopes, interactions, error, and so on. However, they lack the notational knowledge to understand these relations when expressed in the formal notation often used to express these ideas.</p>
<p>Recall from Chapter 1 that our ‘model’ for a single group of normally distributed values can be thought of in one of two two ways:</p>
<p><span class="math display" id="eq:21">\[\begin{equation}
\begin{split}
\\
y_{[i]} = \mu_{[i]} + \varepsilon_{[i]} \\ \\
y_{[i]} \sim \mathcal{N}(\mu_{[i]},\sigma) \\ \\
\end{split}
\tag{2.1}
\end{equation}\]</span></p>
<p>The top line says that your observed variable for any given trial <span class="math inline">\(y_{[i]}\)</span> is the sum of some of some average expected value for that trial, (<span class="math inline">\(\mu_{[i]}\)</span>) and some specific random error for that trial (<span class="math inline">\(\varepsilon_{[i]}\)</span>). The random error is expected to be normally distributed with a mean of 0 and some unknown standard deviation (as in: <span class="math inline">\(\varepsilon_{[i]} \sim \mathcal{N}(0,\sigma)\)</span>). The second line presents the <span class="math inline">\(y\)</span> variable as being a normally-distributed variable with a trial-specific mean of <span class="math inline">\(\mu_i\)</span>, and a fixed standard deviation <span class="math inline">\(\sigma_{error}\)</span></p>
<p>In general, we use regression models to understand orderly variation in <span class="math inline">\(\mu_{[i]}\)</span> from trial to trial by breaking it up into predictors (<span class="math inline">\(\mathrm{x}_{1}, \mathrm{x}_{2},...\)</span>) that are combined using some weights (<span class="math inline">\(\alpha_1, \alpha_2,...\)</span>). If this statement makes no sense please see Chapter 1!.</p>
<p><span class="math display" id="eq:22">\[
\mu_{[i]} = \alpha_1*\mathrm{x}_{1{[i]}} + \alpha_2*\mathrm{x}_{2i}+...+\alpha_j*\mathrm{x}_{j{[i]}}
\tag{2.2}
\]</span></p>
<p>‘Fitting’ a regression model consists of trying to ‘guess’ the values of the weighing factors (<span class="math inline">\(\alpha\)</span>), called the <em>model coefficients</em>. When we are only trying to estimate a single average, we don’t have any predictors to explain variation in <span class="math inline">\(\mu_{[i]}\)</span>. In fact, our model structure suggests we expect no variation in <span class="math inline">\(\mu_{[i]}\)</span> from trial to trial!.</p>
<p>Mathematically, we can’t just say ‘we have no predictor’ since everything needs to be represented by a number. As a result, we use a single ‘predictor’ <span class="math inline">\(\mathrm{x}\)</span> with a value of 1 so that our regression equation is:</p>
<p><span class="math display" id="eq:23">\[
\mu_{[i]} = \alpha_1*1
\tag{2.3}
\]</span></p>
<p>Now our model is trying to guess the value of a single coefficient (<span class="math inline">\(\alpha_1\)</span>), and we expect this coefficient to be equal to <span class="math inline">\(\mu_{[i]}\)</span> since it is being multiplied by a ‘predictor’ with a constant value of 1.</p>
<p>This kind of model is called an ‘Intercept only’ model. Regression models are really about representing <em>differences</em>, differences between groups and across conditions. When you are encoding differences, you need an overall reference point. For example, saying that something is 5 miles north is only interpretable given some reference point. The ‘reference point’ used by your model is called your ‘Intercept’, it is the center of your model’s universe.</p>
<p>Basically, our model consists <em>only</em> of a single reference point, and the <span class="math inline">\(\alpha_1\)</span> parameter reflects its value (as shown in Equation <a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#eq:23">(2.3)</a>). As a result, the <span class="math inline">\(\alpha_1\)</span> coefficient is called the ‘intercept’ in our model. When a coefficient is just being multiplied by a ‘fake’ predictor that just equals 1, we can omit it from the regression model (but its still secretly there).</p>
<p>Based on the above, our model investigating the f0 produced by adult women from Michigan can be thought of like this:</p>
<p><span class="math display" id="eq:24">\[\begin{equation}
\begin{split}
\\
f0_{[i]} \sim \mathcal{N}(\mu_{[i]},\sigma) \\ \\ 
\mu_{[i]} = Intercept \\ \\
\end{split}
\tag{2.4}
\end{equation}\]</span></p>
<p>Put in plain English, each line in the model says the following:</p>
<ul>
<li><p>We expect that f0 for a given observation <span class="math inline">\(i\)</span> is normally distributed according to some trial-specific expected value and some unknown (but fixed) standard deviation.</p></li>
<li><p>The expected value for any given trial (<span class="math inline">\(\mu_{[i]}\)</span>) is equal to the intercept of the model for all trials. This means its fixed and we have the same expected value for all tokens!</p></li>
</ul>
<p>What the model also implicitly says that the error is drawn from a normal distribution with a mean of 0 and a standard deviation of <span class="math inline">\(\sigma\)</span>. This distribution represents all deviations in f0 around the mean f0 for the sample (<span class="math inline">\(\mu_{[i]}\)</span>). In other words, the error for this model is expected to look like:</p>
<p><span class="math display" id="eq:25">\[
\varepsilon_{[i]} \sim \mathcal{N}(0,\sigma)
\tag{2.5}
\]</span></p>
</div>
<div id="the-model-formula" class="section level3" number="2.2.2">
<h3><span class="header-section-number">2.2.2</span> The model formula</h3>
<p>Model structures are expressed in R using a very specific syntax. Think of writing a model formula as writing a language within R. Generally, model formulas in R have the form:</p>
<p><code>y ~ predictors</code></p>
<p>The variable we are interested in understanding (<span class="math inline">\(y\)</span>) goes on the left hand side of the <span class="math inline">\(\sim\)</span>, and on our predictors go on the right hand side. Notice that the random term (<span class="math inline">\(\varepsilon\)</span>) is not included in the model formula.</p>
<p>The formula above can be read as ‘y is distributed according to some predictor’, which really means “we think there is systematic variation in our y variable that can be understood by considering its joint variation with our predictor variable(s).”</p>
<p>For intercept only models, the number <code>1</code> is included in the model formula to indicate that a single constant value is being estimated (as in <a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#eq:23">(2.3)</a>). As a result, our model formula will have the form:</p>
<p><code>f0 ~ 1</code></p>
<p>This model could be said out loud like “we are trying to estimate the mean of f0” or “we are predicting mean f0 given only an intercept”.</p>
</div>
<div id="fitting-the-model-calling-the-brm-function" class="section level3" number="2.2.3">
<h3><span class="header-section-number">2.2.3</span> Fitting the model: Calling the <code>brm</code> function</h3>
<p>Below, I load the <code>brms</code> package, which contains the <code>brm</code> function. The <code>brm</code> function takes a model specification, data and some other information, and fits a model that estimates all the model parameters. Unless otherwise specified, <code>brm</code> assumes that the error component (<span class="math inline">\(\varepsilon\)</span>) of your model is normally distributed. The first argument in the function call is the model formula, and the second argument tells the function where to find the data (a dataframe called <code>w</code>). The other arguments tell the function to estimates a single set of samples (chains = 1) using a single processor on your CPU (cores = 1). These arguments will be discussed more later.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Get data from course website</span></span>
<span id="cb12-2"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb12-2" aria-hidden="true" tabindex="-1"></a>url1 <span class="ot">=</span> <span class="st">&quot;https://raw.githubusercontent.com/santiagobarreda&quot;</span></span>
<span id="cb12-3"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb12-3" aria-hidden="true" tabindex="-1"></a>url2 <span class="ot">=</span> <span class="st">&quot;/stats-class/master/data/h95_vowel_data.csv&quot;</span></span>
<span id="cb12-4"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb12-4" aria-hidden="true" tabindex="-1"></a>h95 <span class="ot">=</span> <span class="fu">read.csv</span> (<span class="fu">url</span>(<span class="fu">paste0</span> (url1, url2)))</span>
<span id="cb12-5"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb12-5" aria-hidden="true" tabindex="-1"></a><span class="co"># select women only</span></span>
<span id="cb12-6"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb12-6" aria-hidden="true" tabindex="-1"></a>w <span class="ot">=</span> h95[h95<span class="sc">$</span>group <span class="sc">==</span> <span class="st">&#39;w&#39;</span>,]</span>
<span id="cb12-7"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb12-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-8"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb12-8" aria-hidden="true" tabindex="-1"></a><span class="co"># To ensure predictable results in examples, I will be using the same random  </span></span>
<span id="cb12-9"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb12-9" aria-hidden="true" tabindex="-1"></a><span class="co"># seed throughout, and resetting it before running any &#39;random&#39; process.  </span></span>
<span id="cb12-10"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb12-10" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span> (<span class="dv">1</span>)</span>
<span id="cb12-11"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb12-11" aria-hidden="true" tabindex="-1"></a>model <span class="ot">=</span> brms<span class="sc">::</span><span class="fu">brm</span> (f0 <span class="sc">~</span> <span class="dv">1</span>, <span class="at">data =</span> w, <span class="at">chains =</span> <span class="dv">1</span>, <span class="at">cores =</span> <span class="dv">1</span>)</span>
<span id="cb12-12"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb12-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-13"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb12-13" aria-hidden="true" tabindex="-1"></a><span class="do">## SAMPLING FOR MODEL &#39;77bdac4488ef47de193e19dae81fc150&#39; NOW (CHAIN 1).</span></span>
<span id="cb12-14"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb12-14" aria-hidden="true" tabindex="-1"></a><span class="do">## Chain 1: </span></span>
<span id="cb12-15"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb12-15" aria-hidden="true" tabindex="-1"></a><span class="do">## Chain 1: Gradient evaluation took 0 seconds</span></span>
<span id="cb12-16"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb12-16" aria-hidden="true" tabindex="-1"></a><span class="do">## Chain 1: 1000 transitions using 10 leapfrog steps per transition would take 0 seconds.</span></span>
<span id="cb12-17"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb12-17" aria-hidden="true" tabindex="-1"></a><span class="do">## Chain 1: Adjust your expectations accordingly!</span></span>
<span id="cb12-18"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb12-18" aria-hidden="true" tabindex="-1"></a><span class="do">## Chain 1: </span></span>
<span id="cb12-19"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb12-19" aria-hidden="true" tabindex="-1"></a><span class="do">## Chain 1: </span></span>
<span id="cb12-20"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb12-20" aria-hidden="true" tabindex="-1"></a><span class="do">## Chain 1: Iteration:    1 / 2000 [  0%]  (Warmup)</span></span>
<span id="cb12-21"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb12-21" aria-hidden="true" tabindex="-1"></a><span class="do">## Chain 1: Iteration:  200 / 2000 [ 10%]  (Warmup)</span></span>
<span id="cb12-22"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb12-22" aria-hidden="true" tabindex="-1"></a><span class="do">## Chain 1: Iteration:  400 / 2000 [ 20%]  (Warmup)</span></span>
<span id="cb12-23"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb12-23" aria-hidden="true" tabindex="-1"></a><span class="do">## Chain 1: Iteration:  600 / 2000 [ 30%]  (Warmup)</span></span>
<span id="cb12-24"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb12-24" aria-hidden="true" tabindex="-1"></a><span class="do">## Chain 1: Iteration:  800 / 2000 [ 40%]  (Warmup)</span></span>
<span id="cb12-25"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb12-25" aria-hidden="true" tabindex="-1"></a><span class="do">## Chain 1: Iteration: 1000 / 2000 [ 50%]  (Warmup)</span></span>
<span id="cb12-26"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb12-26" aria-hidden="true" tabindex="-1"></a><span class="do">## Chain 1: Iteration: 1001 / 2000 [ 50%]  (Sampling)</span></span>
<span id="cb12-27"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb12-27" aria-hidden="true" tabindex="-1"></a><span class="do">## Chain 1: Iteration: 1200 / 2000 [ 60%]  (Sampling)</span></span>
<span id="cb12-28"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb12-28" aria-hidden="true" tabindex="-1"></a><span class="do">## Chain 1: Iteration: 1400 / 2000 [ 70%]  (Sampling)</span></span>
<span id="cb12-29"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb12-29" aria-hidden="true" tabindex="-1"></a><span class="do">## Chain 1: Iteration: 1600 / 2000 [ 80%]  (Sampling)</span></span>
<span id="cb12-30"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb12-30" aria-hidden="true" tabindex="-1"></a><span class="do">## Chain 1: Iteration: 1800 / 2000 [ 90%]  (Sampling)</span></span>
<span id="cb12-31"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb12-31" aria-hidden="true" tabindex="-1"></a><span class="do">## Chain 1: Iteration: 2000 / 2000 [100%]  (Sampling)</span></span>
<span id="cb12-32"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb12-32" aria-hidden="true" tabindex="-1"></a><span class="do">## Chain 1: </span></span>
<span id="cb12-33"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb12-33" aria-hidden="true" tabindex="-1"></a><span class="do">## Chain 1:  Elapsed Time: 0.08 seconds (Warm-up)</span></span>
<span id="cb12-34"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb12-34" aria-hidden="true" tabindex="-1"></a><span class="do">## Chain 1:                0.058 seconds (Sampling)</span></span>
<span id="cb12-35"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb12-35" aria-hidden="true" tabindex="-1"></a><span class="do">## Chain 1:                0.138 seconds (Total)</span></span>
<span id="cb12-36"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb12-36" aria-hidden="true" tabindex="-1"></a><span class="do">## Chain 1: </span></span></code></pre></div>
<p>By default, <code>brms</code> takes 2000 samples, throwing out the first 1000 and returning the last 1000. The output above shows you that the sampler is working, and tells you about the progress as it works. This is a small amount of data so it should be pretty fast.</p>
<p>This is the last time I will be actually fitting a model in the code chunks. I am going to be relying on pre-fit models that you can load after downloading from the course GitHub. Models can be found in the folder corresponding to each chapter.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># download pre-fit model from: </span></span>
<span id="cb13-2"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="co"># github.com/santiagobarreda/stats-class/tree/master/models</span></span>
<span id="cb13-3"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="co"># and load after placing in working directory</span></span>
<span id="cb13-4"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb13-4" aria-hidden="true" tabindex="-1"></a>model <span class="ot">=</span> <span class="fu">readRDS</span> (<span class="st">&#39;2_model.RDS&#39;</span>)</span></code></pre></div>
</div>
<div id="interpreting-the-model-the-print-statement" class="section level3" number="2.2.4">
<h3><span class="header-section-number">2.2.4</span> Interpreting the model: the print statement</h3>
<p>Typing the model name into the console and hitting enter prints the default <code>brms</code> model print statement:</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># inspect model</span></span>
<span id="cb14-2"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb14-2" aria-hidden="true" tabindex="-1"></a>model</span>
<span id="cb14-3"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb14-3" aria-hidden="true" tabindex="-1"></a><span class="do">##  Family: gaussian </span></span>
<span id="cb14-4"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb14-4" aria-hidden="true" tabindex="-1"></a><span class="do">##   Links: mu = identity; sigma = identity </span></span>
<span id="cb14-5"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb14-5" aria-hidden="true" tabindex="-1"></a><span class="do">## Formula: f0 ~ 1 </span></span>
<span id="cb14-6"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb14-6" aria-hidden="true" tabindex="-1"></a><span class="do">##    Data: w (Number of observations: 576) </span></span>
<span id="cb14-7"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb14-7" aria-hidden="true" tabindex="-1"></a><span class="do">## Samples: 1 chains, each with iter = 2000; warmup = 1000; thin = 1;</span></span>
<span id="cb14-8"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb14-8" aria-hidden="true" tabindex="-1"></a><span class="do">##          total post-warmup samples = 1000</span></span>
<span id="cb14-9"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb14-9" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb14-10"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb14-10" aria-hidden="true" tabindex="-1"></a><span class="do">## Population-Level Effects: </span></span>
<span id="cb14-11"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb14-11" aria-hidden="true" tabindex="-1"></a><span class="do">##           Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS</span></span>
<span id="cb14-12"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb14-12" aria-hidden="true" tabindex="-1"></a><span class="do">## Intercept   220.40      0.97   218.33   222.30 1.00      851      557</span></span>
<span id="cb14-13"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb14-13" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb14-14"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb14-14" aria-hidden="true" tabindex="-1"></a><span class="do">## Family Specific Parameters: </span></span>
<span id="cb14-15"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb14-15" aria-hidden="true" tabindex="-1"></a><span class="do">##       Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS</span></span>
<span id="cb14-16"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb14-16" aria-hidden="true" tabindex="-1"></a><span class="do">## sigma    23.24      0.69    21.99    24.61 1.00      653      550</span></span>
<span id="cb14-17"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb14-17" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb14-18"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb14-18" aria-hidden="true" tabindex="-1"></a><span class="do">## Samples were drawn using sampling(NUTS). For each parameter, Bulk_ESS</span></span>
<span id="cb14-19"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb14-19" aria-hidden="true" tabindex="-1"></a><span class="do">## and Tail_ESS are effective sample size measures, and Rhat is the potential</span></span>
<span id="cb14-20"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb14-20" aria-hidden="true" tabindex="-1"></a><span class="do">## scale reduction factor on split chains (at convergence, Rhat = 1).</span></span></code></pre></div>
<p>The first part just tells you some technical details that we don’t have to worry about for now (though some are obvious).</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="do">##  Family: gaussian </span></span>
<span id="cb15-2"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="do">##   Links: mu = identity; sigma = identity </span></span>
<span id="cb15-3"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb15-3" aria-hidden="true" tabindex="-1"></a><span class="do">## Formula: f0 ~ 1 </span></span>
<span id="cb15-4"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb15-4" aria-hidden="true" tabindex="-1"></a><span class="do">##    Data: w (Number of observations: 576) </span></span>
<span id="cb15-5"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb15-5" aria-hidden="true" tabindex="-1"></a><span class="do">## Samples: 1 chains, each with iter = 2000; warmup = 1000; thin = 1;</span></span>
<span id="cb15-6"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb15-6" aria-hidden="true" tabindex="-1"></a><span class="do">##          total post-warmup samples = 1000</span></span></code></pre></div>
<p>Next we see estimated effects for out predictors, in this case only an intercept. This is a ‘population’ level effect because is is shared by all observations in our sample, and not specific to any one observation.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Population-Level Effects: </span></span>
<span id="cb16-2"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="do">##           Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS</span></span>
<span id="cb16-3"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb16-3" aria-hidden="true" tabindex="-1"></a><span class="do">## Intercept   220.40      0.97   218.33   222.30 1.00      851      557</span></span></code></pre></div>
<p>The information above provides the mean (Estimate) and standard deviation (Est. Error) of the posterior distribution of <span class="math inline">\(\mu\)</span> (<code>Intercept</code>). The values of <code>l-95% CI</code> and <code>u-95% CI</code> represent the upper and lower ‘95% credible intervals’ for the posterior distribution of this parameter.</p>
<p>The <em>X% credible interval</em> for a parameter is the smallest interval that encloses X% of the distribution. This parameter has an X% chance (0.X probability) of falling inside the X% credible interval. So, this means that there is a 95% probability that <span class="math inline">\(\mu\)</span> is between 218 and 222 Hz given our data and model structure.</p>
<p>Notice that the parameter estimate and intervals almost exactly match the estimate and intervals we obtain by referencing the theoretical likelihood function (discussed in Chapter 1):</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># sample mean</span></span>
<span id="cb17-2"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span> (f0)</span>
<span id="cb17-3"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb17-3" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 220.401</span></span>
<span id="cb17-4"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb17-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-5"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb17-5" aria-hidden="true" tabindex="-1"></a><span class="co"># theoretical quantiles for likelihood of mean</span></span>
<span id="cb17-6"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb17-6" aria-hidden="true" tabindex="-1"></a><span class="fu">qnorm</span> (<span class="fu">c</span>(<span class="fl">0.025</span>, <span class="fl">0.975</span>), <span class="fu">mean</span> (f0), <span class="fu">sd</span> (f0) <span class="sc">/</span> <span class="fu">sqrt</span> (<span class="fu">length</span> (f0) ) )</span>
<span id="cb17-7"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb17-7" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 218.5047 222.2974</span></span></code></pre></div>
<p>As noted in Chapter 1, ‘frequentist’ and ‘Bayesian’ estimation differ in terms of whether they rely on the posterior or likelihoods to make inferences. However, for most real cases we expect the posterior to be dominated by the likelihood (see <a href="inspecting-a-single-group-of-observations.html#fig:F1-posterior">1.12</a>, and as a result we expect Bayesian and frequentist estimation to provide roughly equivalent answers given equivalent model structures.</p>
<p>Our model also provides us an estimate of the error standard deviation(<span class="math inline">\(\sigma\)</span>), under ‘Family Specific Parameters: sigma’. This estimate closely matches our sample standard deviation estimate (<code>sd(f0)</code>) of 23.2 Hz. In addition, we also get a 95% credible interval for this parameter (2.5% = 21.99, 97.5% = 24.61).</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Family Specific Parameters: </span></span>
<span id="cb18-2"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="do">##       Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS</span></span>
<span id="cb18-3"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb18-3" aria-hidden="true" tabindex="-1"></a><span class="do">## sigma    23.24      0.69    21.99    24.61 1.00      653      550</span></span></code></pre></div>
<p>This last section is just boilerplate and contains some basic reminders. This text will look the same after all models.</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Samples were drawn using sampling(NUTS). For each parameter, Bulk_ESS</span></span>
<span id="cb19-2"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="do">## and Tail_ESS are effective sample size measures, and Rhat is the potential</span></span>
<span id="cb19-3"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb19-3" aria-hidden="true" tabindex="-1"></a><span class="do">## scale reduction factor on split chains (at convergence, Rhat = 1).</span></span></code></pre></div>
</div>
<div id="seeing-the-samples" class="section level3" number="2.2.5">
<h3><span class="header-section-number">2.2.5</span> Seeing the samples</h3>
<p>In Chapter 1 I discussed that samplers (like <code>brm</code>, or STAN) take samples of the posterior distributions of parameters given the data and model structure. It’s helpful to see that this is quite literally what is happening, and that the print statement above just summarizes the information contained in the posterior samples. Actually, one of the great things about Bayesian models is that you can make your own summaries of the posterior samples, and summarize them in several ways as required.</p>
<p>Below I get the posterior samples from the model. We have 1000 samples, as indicated in the model output above. The first column represents the model intercept (<code>b_Intercept</code>), the middle column is the error (<code>sigma</code>), and the third column is a statistic related to model fit (<code>lp__</code>).</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># get posterior samples from model</span></span>
<span id="cb20-2"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb20-2" aria-hidden="true" tabindex="-1"></a>samples <span class="ot">=</span> brms<span class="sc">::</span><span class="fu">posterior_samples</span> (model)</span>
<span id="cb20-3"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb20-3" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span> (samples)</span>
<span id="cb20-4"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb20-4" aria-hidden="true" tabindex="-1"></a><span class="do">## &#39;data.frame&#39;:    1000 obs. of  3 variables:</span></span>
<span id="cb20-5"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb20-5" aria-hidden="true" tabindex="-1"></a><span class="do">##  $ b_Intercept: num  221 221 220 222 220 ...</span></span>
<span id="cb20-6"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb20-6" aria-hidden="true" tabindex="-1"></a><span class="do">##  $ sigma      : num  22.1 21.9 23.2 21.9 22.9 ...</span></span>
<span id="cb20-7"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb20-7" aria-hidden="true" tabindex="-1"></a><span class="do">##  $ lp__       : num  -2635 -2635 -2634 -2637 -2634 ...</span></span></code></pre></div>
<p>We can plot the individual samples for the mean parameter on the left below. On the right I plot a histogram of the same samples, superimposed with the theoretical distribution of the likelihood we calculated in Chapter 1.</p>
<div class="figure"><span id="fig:F2-1"></span>
<img src="02_files/figure-html/F2-1-1.png" alt="(left) Individual samples from posterior of mean f0 parameter. (right) a histogram of the same samples." width="768" />
<p class="caption">
Figure 2.1: (left) Individual samples from posterior of mean f0 parameter. (right) a histogram of the same samples.
</p>
</div>
<p>Recall that our model output provides information about expected values for the mean parameter:</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Population-Level Effects: </span></span>
<span id="cb21-2"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="do">##           Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS</span></span>
<span id="cb21-3"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb21-3" aria-hidden="true" tabindex="-1"></a><span class="do">## Intercept   220.40      0.97   218.33   222.30 1.00      851      557</span></span></code></pre></div>
<p>These simply correspond to the quantiles of the posterior samples! We can confirm this by checking the quantiles on the vector containing the posterior samples for the mean parameter as below:</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">quantile</span> (samples[,<span class="st">&quot;b_Intercept&quot;</span>], <span class="fu">c</span>(.<span class="dv">025</span>, .<span class="dv">5</span>, .<span class="dv">975</span>))</span>
<span id="cb22-2"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="do">##     2.5%      50%    97.5% </span></span>
<span id="cb22-3"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb22-3" aria-hidden="true" tabindex="-1"></a><span class="do">## 218.3288 220.3997 222.3001</span></span></code></pre></div>
<p>And we can see that these exactly correspond to the values of <code>Estimate</code>, <code>l-95% CI</code>, and <code>u-95% CI</code> in the model print statement above. There is no special status for these quantiles. We can check the values of other ones:</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">quantile</span> (samples[,<span class="st">&quot;b_Intercept&quot;</span>], <span class="fu">c</span>(.<span class="dv">25</span>, .<span class="dv">75</span>))</span>
<span id="cb23-2"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="do">##      25%      75% </span></span>
<span id="cb23-3"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb23-3" aria-hidden="true" tabindex="-1"></a><span class="do">## 219.8043 221.0296</span></span></code></pre></div>
<p>Or even use the posterior distribution to find the probability that the mean parameter is over/under any arbitrary value:</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span> (samples[,<span class="st">&quot;b_Intercept&quot;</span>] <span class="sc">&lt;</span> <span class="dv">221</span>) <span class="sc">/</span> <span class="dv">576</span></span>
<span id="cb24-2"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb24-2" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 1.284722</span></span></code></pre></div>
<p>Let’s take a second to think about why this works. Recall that the probability is the odds that something will occur out of all the possible outcomes. Our vector <code>samples[,"b_Intercept"]</code> represents 1000 observations of a random variable, 1000 possible values of the average f0 produced by adult women from Michigan. If we find the total number of these observations that were below 221 Hz and then divide by the total number of observations (576), we are calculating the probability of observing a mean estimate below 221 Hz. As a result, the calculation above says that there is a 0.74 probability (a 74% chance) that the mean f0 for female speakers in this population is under 221 Hz, given our data and model structure. We come to this conclusion by finding that 74% of the posterior samples of the parameter of interest are below 221 Hz.</p>
</div>
</div>
<div id="repeated-measures-data" class="section level2" number="2.3">
<h2><span class="header-section-number">2.3</span> Repeated measures data</h2>
<p>The model we fit above is a reasonable starting point, but it has many weaknesses. Importantly, our data consists of 12 productions from each speaker in our sample, meaning we have ‘repeated measures’ data. However, our model does not contain this information an thinks that the 576 observations in our data are entirely independent. Treating repeated measures data as if it were <em>not</em> repeated measures data can cause problems for our inferences. This is because it can give us a warped perspective of how much variability there really is in the sample.</p>
<p>For example, if I told you I had 1,000,000 samples of speech from male speakers from Los Angeles, you may be confident that I can estimate the average f0 male speakers from Los Angeles very accurately. But what if I told you that all these samples were from only three different people? You know instinctively that this makes my data less reliable for making inferences about Los Angeles in general, although it may provide excellent information about these three speakers.</p>
<p>The reason repeated-measures data can cause problems is because the measurements are correlated: multiple measurements from the same person are obviously going to be related to each other. If you measure the height of a tall person today, they will still be tall tomorrow. This can be seen quite clearly below. The top panel shows the distribution of all our f0 measurements. The bottom panel shows speaker boxplots (one for each speaker’s data). If we were to ‘push down’ on the bottom panel and collapse all our boxplots into a single distribution, we would end up with the boxplot in the top panel.</p>
<p>These boxplots shows that each speaker has their own average f0, and that their productions tend to vary around their ‘natural average. As a result, we might have something closer to 48 independent observations (one average value per speaker) than 576. For example, if we look at the top boxplot there appear to be ’outliers’ around 150 Hz. In the bottom plot we see that these productions all come from one speaker, and actually reflect her average f0. As a result, it seems that the <em>speaker</em> is the outlier, and that the values are actually perfectly average for this speaker.</p>
<div class="figure"><span id="fig:F2-2"></span>
<img src="02_files/figure-html/F2-2-1.png" alt="(top) Boxplot of overall distribution. (bottom) Speaker-specific boxplot of our f0 data." width="768" />
<p class="caption">
Figure 2.2: (top) Boxplot of overall distribution. (bottom) Speaker-specific boxplot of our f0 data.
</p>
</div>
<div id="multilevel-models" class="section level3" number="2.3.1">
<h3><span class="header-section-number">2.3.1</span> Multilevel models</h3>
<p>In linguistics (and many other similar fields) almost all of our data is repeated measures data. The methods most commonly-used by linguists (e.g., experiments, interviews, corpora, … etc.) yield many observations per person, and typically all involve data from multiple people/sources. As a result, the analysis of this data requires that models be able to account for within <em>and</em> between speaker variation in our data. Multilevel models address the correlated nature of repeated measures data by estimating multiple sources of variation simultaneously.</p>
<p>We can think about how this applies to our f0 sample. Each person picked at random has some average f0 they produce. This is <em>between-speaker</em> variation: If you pick to people at random they will differ. However, each person also produces a different random f0 every time they speak, so that they will never produce exactly their average f0: this is <em>within-speaker</em> variation.</p>
<p>Repeated-measures data leads to random variation in parameters that is <em>indistinguishable</em> from that of our ‘data’. For example, consider the figure below. First we consider a single speaker’s production (left) and produce a histogram that suggests a normal distribution reminiscent in shape to the overall aggregated data. In the middle, we see individual boxplots showing variation in speaker averages. Here we see that although each speakers productions are a distribution, variation in the distribution of the speaker averages is its own sort of distribution. Finally, on the right we see a histogram of the speaker averages and see that these are also normally distributed.</p>
<p>To a large extent, whether something is a parameter or a data point depends somewhat on your perspective. For example, consider the figure below. If you are trying to estimate a speaker’s mean f0, then the individual productions might be ‘data’ and the mean can be thought of as a ‘parameter’. If you were instead only interested in the population average, maybe now your subject mean is actually just a single data point, and the <em>population</em> mean is actually your ‘parameter’.</p>
<div class="figure"><span id="fig:F2-3"></span>
<img src="02_files/figure-html/F2-3-1.png" alt="(top left) All the f0 data (top right) A boxplot of the same data. (bottom left) Speaker-specific boxplots, with a vertical line for speaker 107. (bottom right) The histogram of data produced by speaker 107." width="768" />
<p class="caption">
Figure 2.3: (top left) All the f0 data (top right) A boxplot of the same data. (bottom left) Speaker-specific boxplots, with a vertical line for speaker 107. (bottom right) The histogram of data produced by speaker 107.
</p>
</div>
<p>A multilevel model is able to simultaneously estimate variation at multiple ‘levels’. This is actually why it’s called a <em>multilevel</em> model! For our f0 data, our ‘levels’ are:</p>
<ul>
<li><p>The ‘upper’ level: Between-speaker variation in mean f0. This can be thought of as variation in a new variable, which we will call <span class="math inline">\(\mu_{speaker}\)</span>. Speakers have an average f0 (<span class="math inline">\(\mu_{speaker}\)</span>) that they produce over time. However, speakers are chosen randomly from a larger population, and so any given speaker’s <span class="math inline">\(\mu_{speaker}\)</span> is unpredictable a priori.</p></li>
<li><p>The ‘lower’ level: Within-speaker variation, random error analogous to <span class="math inline">\(\varepsilon\)</span>. When an individual speaker produces speech, their productions will vary around their average from token to token. Our model cannot explain this and so this is ‘error’</p></li>
</ul>
<p>As seen in the figure above, the variation at the lower and upper levels are analogous. Just like individual speakers will rarely have an average f0 exactly like the population average, individual speakers will rarely produce f0 values exactly at their speaker average. Importantly, variation at the two levels is independent and logically distinct: within-speaker variation can be small or large independently of whether between-speaker variation is large or small.</p>
<p>Basically, each subject’s productions form a little normal distribution around their average, and the mix of these little distributions results in the overall ‘big’ distribution of data across all subjects. By using multilevel models, we can estimate the effects of multiple sources of variation at the same time.</p>
</div>
</div>
<div id="estimating-a-multilevel-model-with-brms" class="section level2" number="2.4">
<h2><span class="header-section-number">2.4</span> Estimating a multilevel model with <code>brms</code></h2>
<p>We’re now going to fit the same model we fit above, but with a structure that reflects the repeated-measures nature of the data. Whereas the last model was a pedagogical device, this model structure is actually appropriate to analyze this particular dataset.</p>
<div id="description-of-the-model-1" class="section level3" number="2.4.1">
<h3><span class="header-section-number">2.4.1</span> Description of the model</h3>
<p>We’re going to keep working on developing an intuitive understanding for model notation, and using it to describe models. Just keep in mind that this is nothing more than an efficient way to denote the concepts being discussed in the text.</p>
<p>To specify a multilevel model, you need to write a slightly more complicated model formula. This explanation assumes that you have a dataframe or matrix where one column contains the variable you are interested in predicting (in this case <code>f0</code>), and another column contains a vector containing unique labels for each speaker/listener/participant (in this case a unique speaker label <code>speaker</code>).</p>
<p>To indicate that your model contains an ‘upper’ level where you have clusters of data coming from different individuals, you have to put another model inside your main model!</p>
<p>Before, the model formula looked like this:</p>
<p><code>f0 ~ 1</code></p>
<p>which meant ‘predict f0 using only an intercept’. Now the model formula will look like this:</p>
<p><code>f0 ~ 1 + ( 1 | speaker)</code></p>
<p>When you place a predictor in the formula in parenthesis and on the right-hand-side of a pipe, like this <code>( | predictor )</code>, you tell <code>brm</code> that you expect data to be clustered according to each category represented in the grouping vector. In this case, we are telling <code>brm</code> that each unique speaker is a cluster of data. Whatever you put in the left-hand-side of the parentheses <code>( in here | predictor )</code> is the model for each subcluster!</p>
<p>So what does this model formula mean: <code>f0 ~ 1 + ( 1 | speaker)</code>? Remember a model formula consisting only of a <code>1</code> tells <code>brm</code> that we have an Intercept-only model. So, our new formula tells <code>brm</code>: predict f0 based on only an overall intercept, but also estimate a different intercept for each speaker. Effectively, this model formula is telling <code>brm</code> to figure out all the information presented in the figures above.</p>
<p>This regression model is now something like this:</p>
<p><span class="math display" id="eq:26">\[\begin{equation}
\begin{split}
\\
f0_{[i]} \sim \mathcal{N}(\mu_{[i]},\sigma) \\ \\
\mu_{[i]} = Intercept + \alpha_{speaker_{[i]}} \\
\\
\end{split}
\tag{2.6}
\end{equation}\]</span></p>
<p>In plain English, the model above says: we expect f0 to be normally distributed. The f0 value we expect for any given token is equal to some overall average (<span class="math inline">\(Intercept\)</span>), and some value associated with the individual speaker (<span class="math inline">\(\alpha_{speaker_{[i]}}\)</span>) who uttered the trial.</p>
<p>We now have another term <span class="math inline">\(\alpha_{speaker}\)</span>, in addition to the intercept. This coefficient is actually a set of coefficients since it has a different value for each speaker (it’s a vector). Notice that the although the Intercept is fixed, value of <span class="math inline">\(\alpha_{speaker}\)</span> that should be used will vary from trial to trial based on the speaker associated with the trial. We will discuss coefficients like these in more detail later, we don’t really need to worry about it for now.</p>
<p>The value of <span class="math inline">\(\alpha_{speaker}\)</span> has a different value for each speaker because it will reflect variation in <span class="math inline">\(\mu_{speaker}\)</span>, the average f0 value produced by each speaker. However, <span class="math inline">\(\mu_{speaker}\)</span> is a random variable since it reflects the random average f0 of each person drawn from the population. If <span class="math inline">\(\mu_{speaker}\)</span> behaves like a random variable, then the coefficients that reflect this value in our model (<span class="math inline">\(\alpha_{speaker}\)</span>) will behave in the same way.</p>
<p>This means that our model actually has <em>two</em> random variables. The first one is the error term <span class="math inline">\(\varepsilon_{[i]} \sim \mathcal{N}(0,\sigma_{error})\)</span>, which has a mean of 0 and a standard deviation which we can refer to as <span class="math inline">\(\sigma_{error}\)</span>. The second is the random coefficients that allow for speaker-specific adjustments to the intercept (<span class="math inline">\(\alpha_{speaker}\)</span>). These can also be thought of as random draw from a normal distribution.</p>
<p>A careful consideration of the model in equation 2.4 suggests that the (<span class="math inline">\(\alpha_{speaker}\)</span>) coefficients can’t actually be exactly equal to <span class="math inline">\(\mu_{speaker}\)</span>, the average f0 for a speaker. If the overall mean (the intercept) is 220 Hz and a speaker’s average is 230, this would suggest a predicted average of 450 (<span class="math inline">\(Intercept + \mu_{speaker}\)</span>) for this speaker. Clearly that is not how the model should be working.</p>
<p>Recall that regression models encode <em>differences</em>, rather than absolute values. Our model already represents the overall data average in the intercept parameter. Thus, the speaker-specific averages only need to contain information about <em>differences</em> to this reference value. As a result, coefficients such as <span class="math inline">\(\alpha_{speaker}\)</span> are modelled as being normally distributed with a mean of 0, and with some population-specific standard deviation.</p>
<p>Since our model coefficients reflect speaker-specific <em>deviations</em> rather than the actual mean f0 of different speakers, people often use this symbol, <span class="math inline">\(\gamma\)</span>, for them instead of <span class="math inline">\(\mu\)</span>, where <span class="math inline">\(\gamma\)</span> reflects the difference between the speaker means and the mean for the population of speakers, <span class="math inline">\(\gamma_{speaker} = \mu_{speaker} - \mu_{population}\)</span>.</p>
<p>We can show the expected distribution of this variable below, where <span class="math inline">\(\sigma_{speakers}\)</span> is a population-specific standard deviation term. Note the similarity of this to the expected variation in our original data in Equation <a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#eq:24">(2.4)</a>.</p>
<p><span class="math display" id="eq:27">\[\begin{equation}
\begin{split}
\\
\gamma_{speaker} \sim \mathcal{N}(0,\sigma_{speakers}) \\ \\ 
\gamma_{speaker} = \alpha_{speaker} \\ \\
\end{split}
\tag{2.7}
\end{equation}\]</span></p>
<p>Our overall model is now as shown below, made specific for the data we have, and using expected parameter names.</p>
<p><span class="math display" id="eq:28">\[\begin{equation}
\begin{split}
\\
f0_{[i]} \sim \mathcal{N}(\mu_{[i]},\sigma_{error}) \\ \\
\mu_{[i]} = Intercept + \alpha_{speaker_{[i]}} \\ \\
\alpha_{speaker} \sim \mathcal{N}(0,\sigma_{speakers}) \\ \\
\end{split}
\tag{2.8}
\end{equation}\]</span></p>
<p>Each line in the model says the following:</p>
<ul>
<li><p>observed f0 is expected to be normally distributed around a trial-specific mean, with some unknown but fixed standard deviation (<span class="math inline">\(\sigma_{error}\)</span>).</p></li>
<li><p>the expected value for a given trial (<span class="math inline">\(\mu_{[i]}\)</span>) is equal to the model intercept, plus some speaker-specific deviation/difference from the intercept for the speaker that produced that trial (<span class="math inline">\(\alpha_{speaker_{[i]}}\)</span>).</p></li>
<li><p>the speaker effects (<span class="math inline">\(\alpha_{speaker}\)</span>) are also drawn from a normal distribution with a mean of 0 and a standard deviation of <span class="math inline">\(\sigma_{speakers}\)</span>. This distribution represents the random, but systematic, between-speaker variation in average productions that exists within any population of speakers.</p></li>
</ul>
<p>All of this information can be seen in the speaker boxplots below. The model intercept (horizontal dotted line) represents the overall mean, and the variation in <span class="math inline">\(\alpha_{speaker}\)</span> is what causes the middle of each little box to differ from the mean. Finally, the error causes there to be a spread, a <em>distribution</em>, around each speaker’s individual mean.</p>
<div class="figure"><span id="fig:F2-4"></span>
<img src="02_files/figure-html/F2-4-1.png" alt="Speaker-specific boxplots for the f0 data." width="768" />
<p class="caption">
Figure 2.4: Speaker-specific boxplots for the f0 data.
</p>
</div>
<p>There is a very important difference in how the first and second models we fit view and partition the variation in our model. The initial model we fit broke down the total variation in the model (<span class="math inline">\(\sigma_{total}\)</span>) like this:</p>
<p><span class="math display" id="eq:29">\[
\sigma_{total} = \sigma_{error}
\tag{2.9}
\]</span></p>
<p>In other words, all variation was error. We don’t know why values vary from the mean. Our multilevel model views the variation in our data like this:</p>
<p><span class="math display" id="eq:210">\[
\sigma_{total} = \sigma_{speaker} + \sigma_{error}
\tag{2.10}
\]</span></p>
<p>From the perspective of this model, only the variation <em>within</em> a speaker’s individual boxplot is error. The differences from box to box represent random (but systematic) between-speaker variation in f0.</p>
</div>
<div id="fitting-the-model" class="section level3" number="2.4.2">
<h3><span class="header-section-number">2.4.2</span> Fitting the model</h3>
<p>We can fit a model with a formula that appropriately specifies the clustering we expect in our data. As a result, this model can estimate both between- and within-speaker variability.</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit the model yourself, or</span></span>
<span id="cb25-2"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span> (<span class="dv">1</span>)</span>
<span id="cb25-3"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb25-3" aria-hidden="true" tabindex="-1"></a>multilevel_model <span class="ot">=</span>  </span>
<span id="cb25-4"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb25-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">brm</span> (f0 <span class="sc">~</span> (<span class="dv">1</span><span class="sc">|</span>speaker), <span class="at">data =</span> w, <span class="at">chains =</span> <span class="dv">1</span>, <span class="at">cores =</span> <span class="dv">1</span>)</span>
<span id="cb25-5"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb25-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-6"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb25-6" aria-hidden="true" tabindex="-1"></a><span class="co"># download pre-fit model from: </span></span>
<span id="cb25-7"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb25-7" aria-hidden="true" tabindex="-1"></a><span class="co"># github.com/santiagobarreda/stats-class/tree/master/models</span></span>
<span id="cb25-8"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb25-8" aria-hidden="true" tabindex="-1"></a><span class="co"># and load after placing in working directory</span></span>
<span id="cb25-9"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb25-9" aria-hidden="true" tabindex="-1"></a>multilevel_model <span class="ot">=</span> <span class="fu">readRDS</span> (<span class="st">&quot;2_multilevel_model.RDS&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co"># inspect model</span></span>
<span id="cb26-2"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb26-2" aria-hidden="true" tabindex="-1"></a>multilevel_model</span>
<span id="cb26-3"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb26-3" aria-hidden="true" tabindex="-1"></a><span class="do">##  Family: gaussian </span></span>
<span id="cb26-4"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb26-4" aria-hidden="true" tabindex="-1"></a><span class="do">##   Links: mu = identity; sigma = identity </span></span>
<span id="cb26-5"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb26-5" aria-hidden="true" tabindex="-1"></a><span class="do">## Formula: f0 ~ (1 | uspeaker) </span></span>
<span id="cb26-6"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb26-6" aria-hidden="true" tabindex="-1"></a><span class="do">##    Data: w (Number of observations: 576) </span></span>
<span id="cb26-7"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb26-7" aria-hidden="true" tabindex="-1"></a><span class="do">## Samples: 1 chains, each with iter = 2000; warmup = 1000; thin = 1;</span></span>
<span id="cb26-8"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb26-8" aria-hidden="true" tabindex="-1"></a><span class="do">##          total post-warmup samples = 1000</span></span>
<span id="cb26-9"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb26-9" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb26-10"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb26-10" aria-hidden="true" tabindex="-1"></a><span class="do">## Group-Level Effects: </span></span>
<span id="cb26-11"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb26-11" aria-hidden="true" tabindex="-1"></a><span class="do">## ~uspeaker (Number of levels: 48) </span></span>
<span id="cb26-12"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb26-12" aria-hidden="true" tabindex="-1"></a><span class="do">##               Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS</span></span>
<span id="cb26-13"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb26-13" aria-hidden="true" tabindex="-1"></a><span class="do">## sd(Intercept)    20.19      2.10    16.65    25.06 1.00      135      192</span></span>
<span id="cb26-14"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb26-14" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb26-15"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb26-15" aria-hidden="true" tabindex="-1"></a><span class="do">## Population-Level Effects: </span></span>
<span id="cb26-16"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb26-16" aria-hidden="true" tabindex="-1"></a><span class="do">##           Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS</span></span>
<span id="cb26-17"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb26-17" aria-hidden="true" tabindex="-1"></a><span class="do">## Intercept   220.39      3.10   214.49   226.13 1.03       51      108</span></span>
<span id="cb26-18"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb26-18" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb26-19"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb26-19" aria-hidden="true" tabindex="-1"></a><span class="do">## Family Specific Parameters: </span></span>
<span id="cb26-20"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb26-20" aria-hidden="true" tabindex="-1"></a><span class="do">##       Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS</span></span>
<span id="cb26-21"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb26-21" aria-hidden="true" tabindex="-1"></a><span class="do">## sigma    12.54      0.39    11.83    13.34 1.01      400      700</span></span>
<span id="cb26-22"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb26-22" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb26-23"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb26-23" aria-hidden="true" tabindex="-1"></a><span class="do">## Samples were drawn using sampling(NUTS). For each parameter, Bulk_ESS</span></span>
<span id="cb26-24"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb26-24" aria-hidden="true" tabindex="-1"></a><span class="do">## and Tail_ESS are effective sample size measures, and Rhat is the potential</span></span>
<span id="cb26-25"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb26-25" aria-hidden="true" tabindex="-1"></a><span class="do">## scale reduction factor on split chains (at convergence, Rhat = 1).</span></span></code></pre></div>
<p>This new model contains one new chunk its print statement. This section tells us about the standard deviation for the Intercept (<code>sd(Intercept)</code>) for the <code>~speaker</code> cluster:</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Group-Level Effects: </span></span>
<span id="cb27-2"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="do">## ~speaker (Number of levels: 48) </span></span>
<span id="cb27-3"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb27-3" aria-hidden="true" tabindex="-1"></a><span class="do">##               Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS</span></span>
<span id="cb27-4"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb27-4" aria-hidden="true" tabindex="-1"></a><span class="do">## sd(Intercept)    20.19      2.10    16.65    25.06 1.00      135      192</span></span></code></pre></div>
<p>This parameter corresponds to <span class="math inline">\(\sigma_{speaker}\)</span> above, the standard deviation of between-speaker averages (<span class="math inline">\(\alpha_{speaker}\)</span>) in the sample. Below, we calculate the speaker mean f0 values, the standard deviation of these, and the amount of within-speaker variation in f0s.</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co"># find mean f0 for each speaker</span></span>
<span id="cb28-2"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb28-2" aria-hidden="true" tabindex="-1"></a>speaker_means <span class="ot">=</span> <span class="fu">aggregate</span> (f0 <span class="sc">~</span> speaker, <span class="at">data =</span> w, <span class="at">FUN =</span> mean) </span>
<span id="cb28-3"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb28-3" aria-hidden="true" tabindex="-1"></a><span class="co"># find the within speaker standard deviation This is the within-talker &#39;error&#39;.</span></span>
<span id="cb28-4"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb28-4" aria-hidden="true" tabindex="-1"></a>speaker_sigmas <span class="ot">=</span> <span class="fu">aggregate</span> (f0 <span class="sc">~</span> speaker, <span class="at">data =</span> w, <span class="at">FUN =</span> sd) </span>
<span id="cb28-5"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb28-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-6"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb28-6" aria-hidden="true" tabindex="-1"></a><span class="co"># the mean of the speaker means corresponds to our overall mean estimate</span></span>
<span id="cb28-7"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb28-7" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span> (speaker_means<span class="sc">$</span>f0)</span>
<span id="cb28-8"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb28-8" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 220.401</span></span>
<span id="cb28-9"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb28-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-10"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb28-10" aria-hidden="true" tabindex="-1"></a><span class="co"># the standard deviation of the speaker means corresponds to &#39;sd(Intercept)&#39;, the </span></span>
<span id="cb28-11"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb28-11" aria-hidden="true" tabindex="-1"></a><span class="co"># estimate of the standard deviation of speaker intercepts</span></span>
<span id="cb28-12"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb28-12" aria-hidden="true" tabindex="-1"></a><span class="fu">sd</span> (speaker_means<span class="sc">$</span>f0)</span>
<span id="cb28-13"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb28-13" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 20.07397</span></span>
<span id="cb28-14"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb28-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-15"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb28-15" aria-hidden="true" tabindex="-1"></a><span class="co"># the average within-speaker standard deviation corresponds to &#39;sigma&#39;, the </span></span>
<span id="cb28-16"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb28-16" aria-hidden="true" tabindex="-1"></a><span class="co"># estimated error</span></span>
<span id="cb28-17"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb28-17" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span> (speaker_sigmas<span class="sc">$</span>f0)</span>
<span id="cb28-18"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb28-18" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 11.6791</span></span></code></pre></div>
<p>We are going to discuss the calculations we made above in terms of what they represent in the boxplots below. The overall mean f0 in our data (220.4) corresponds quite well to our model estimate of 220.4. This reflects the central location of the overall distribution below (the horizontal line in the figure below). The standard deviation of the speaker means (20.1) is again very similar to our model estimate (sd(Intercept) = 20.2). This reflects the average distance from each speaker’s average to the overall average. Finally, the average of the within speaker standard deviation in our data (11.7) corresponds closely to our model’s error estimate (sigma = 12.5). This reflects the average spread of each speaker’s data relative to their own mean, within their own little boxplot. We can see that the information provided by <code>brms</code> is quite similar to what we can estimate directly using our data. However, <em>brms</em> does this all for us, in addition to giving us a lot more information.</p>
<div class="figure"><span id="fig:F2-5"></span>
<img src="02_files/figure-html/F2-5-1.png" alt="Speaker-specific boxplots for the f0 data we are analyzing." width="768" />
<p class="caption">
Figure 2.5: Speaker-specific boxplots for the f0 data we are analyzing.
</p>
</div>
</div>
</div>
<div id="checking-model-convergence" class="section level2" number="2.5">
<h2><span class="header-section-number">2.5</span> Checking model convergence</h2>
<p>Remember that our parameter estimates are based of a set of samples from the posterior distribution of a parameter. If we don’t take enough of these samples, our parameter estimates will be unreliable.</p>
<p>For this reason, it’s important to look at the ESS values (the ‘expected sample size’), and the ‘Rhat’ values provided by <code>brm</code>. ESS tells you about how many independent samples you have taken from the likelihood. Bulk ESS is how many samples the sampler took in the thick part of the density, and Tail ESS reflects how much time the sampler spent in the thin part, the ‘tails’. Rhat tells you about whether your ‘chains’ have converged (more on this later). As noted above, values of Rhat near 1 are good, and values higher than around 1.1 are a bad sign.</p>
<p>We haven’t really taken many samples here, so we can’t be confident in our parameter estimates. Ideally we would like several hundred samples (at least) for mean estimates, and thousands to be confident in the 95% confidence intervals. If you fit a model and get a warning message like this:</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Warning messages:</span></span>
<span id="cb29-2"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb29-2" aria-hidden="true" tabindex="-1"></a><span class="do">## 1: Bulk Effective Samples Size (ESS) is too low, indicating posterior means and medians may be unreliable.</span></span>
<span id="cb29-3"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb29-3" aria-hidden="true" tabindex="-1"></a><span class="do">## Running the chains for more iterations may help. See</span></span>
<span id="cb29-4"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb29-4" aria-hidden="true" tabindex="-1"></a><span class="do">## http://mc-stan.org/misc/warnings.html#bulk-ess</span></span>
<span id="cb29-5"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb29-5" aria-hidden="true" tabindex="-1"></a><span class="do">## 2: Tail Effective Samples Size (ESS) is too low, indicating posterior variances and tail quantiles may be unreliable.</span></span>
<span id="cb29-6"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb29-6" aria-hidden="true" tabindex="-1"></a><span class="do">## Running the chains for more iterations may help. See</span></span>
<span id="cb29-7"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb29-7" aria-hidden="true" tabindex="-1"></a><span class="do">## http://mc-stan.org/misc/warnings.html#tail-ess</span></span></code></pre></div>
<p>That is <code>brms</code> telling you that you need to collect more samples in order to be confident in your parameter estimates. To get more samples we can run the model longer, or we can use more <em>chains</em>. A chain is basically a separate set of samples for your parameter values. A model can be fit in parallel across several chains, and then the estimates can be merged across chains. When you do this across multiple cores, you can get N times as many samples when you use N cores. Since many computers these days have 4-8 (or more) cores, we can take advantage of parallel processing to fit models faster.</p>
<p>Before fitting a model across multiple cores, you should confirm how many you have. You can use the following command (you may need to install the <code>parallel</code> package):</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb30-1" aria-hidden="true" tabindex="-1"></a>parallel<span class="sc">::</span><span class="fu">detectCores</span>()</span></code></pre></div>
<p>I will be using four cores to fit models throughout. If you only have 4 total cores, consider changing the model fits to 2-3 chains and cores. One thing to keep in mind is that these models are computationally intensive to fit. As the datasets become larger and the models become more complicated, more powerful computers are needed in order to fit a model in a reasonable amount of time.</p>
<p>Below, I refit the same model from above but run it on 4 chains, and on 4 cores at once.</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit the model yourself, or</span></span>
<span id="cb31-2"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb31-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span> (<span class="dv">1</span>)</span>
<span id="cb31-3"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb31-3" aria-hidden="true" tabindex="-1"></a>multilevel_multicore <span class="ot">=</span>  </span>
<span id="cb31-4"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb31-4" aria-hidden="true" tabindex="-1"></a>  brms<span class="sc">::</span><span class="fu">brm</span> (f0 <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>speaker), <span class="at">data =</span> w, <span class="at">chains =</span> <span class="dv">4</span>, <span class="at">cores =</span> <span class="dv">4</span>)</span>
<span id="cb31-5"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb31-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-6"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb31-6" aria-hidden="true" tabindex="-1"></a><span class="co"># download pre-fit model from: </span></span>
<span id="cb31-7"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb31-7" aria-hidden="true" tabindex="-1"></a><span class="co"># github.com/santiagobarreda/stats-class/tree/master/models</span></span>
<span id="cb31-8"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb31-8" aria-hidden="true" tabindex="-1"></a><span class="co"># and load after placing in working directory</span></span>
<span id="cb31-9"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb31-9" aria-hidden="true" tabindex="-1"></a>multilevel_multicore <span class="ot">=</span> <span class="fu">readRDS</span> (<span class="st">&#39;2_multilevel_multicore.RDS&#39;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co"># inspect model</span></span>
<span id="cb32-2"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb32-2" aria-hidden="true" tabindex="-1"></a>multilevel_multicore</span>
<span id="cb32-3"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb32-3" aria-hidden="true" tabindex="-1"></a><span class="do">##  Family: gaussian </span></span>
<span id="cb32-4"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb32-4" aria-hidden="true" tabindex="-1"></a><span class="do">##   Links: mu = identity; sigma = identity </span></span>
<span id="cb32-5"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb32-5" aria-hidden="true" tabindex="-1"></a><span class="do">## Formula: f0 ~ 1 + (1 | uspeaker) </span></span>
<span id="cb32-6"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb32-6" aria-hidden="true" tabindex="-1"></a><span class="do">##    Data: w (Number of observations: 576) </span></span>
<span id="cb32-7"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb32-7" aria-hidden="true" tabindex="-1"></a><span class="do">## Samples: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;</span></span>
<span id="cb32-8"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb32-8" aria-hidden="true" tabindex="-1"></a><span class="do">##          total post-warmup samples = 4000</span></span>
<span id="cb32-9"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb32-9" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb32-10"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb32-10" aria-hidden="true" tabindex="-1"></a><span class="do">## Group-Level Effects: </span></span>
<span id="cb32-11"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb32-11" aria-hidden="true" tabindex="-1"></a><span class="do">## ~uspeaker (Number of levels: 48) </span></span>
<span id="cb32-12"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb32-12" aria-hidden="true" tabindex="-1"></a><span class="do">##               Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS</span></span>
<span id="cb32-13"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb32-13" aria-hidden="true" tabindex="-1"></a><span class="do">## sd(Intercept)    20.22      2.19    16.54    25.19 1.02      345      615</span></span>
<span id="cb32-14"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb32-14" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb32-15"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb32-15" aria-hidden="true" tabindex="-1"></a><span class="do">## Population-Level Effects: </span></span>
<span id="cb32-16"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb32-16" aria-hidden="true" tabindex="-1"></a><span class="do">##           Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS</span></span>
<span id="cb32-17"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb32-17" aria-hidden="true" tabindex="-1"></a><span class="do">## Intercept   220.47      2.91   214.67   226.14 1.02      228      543</span></span>
<span id="cb32-18"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb32-18" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb32-19"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb32-19" aria-hidden="true" tabindex="-1"></a><span class="do">## Family Specific Parameters: </span></span>
<span id="cb32-20"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb32-20" aria-hidden="true" tabindex="-1"></a><span class="do">##       Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS</span></span>
<span id="cb32-21"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb32-21" aria-hidden="true" tabindex="-1"></a><span class="do">## sigma    12.54      0.39    11.81    13.34 1.00     3427     2943</span></span>
<span id="cb32-22"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb32-22" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb32-23"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb32-23" aria-hidden="true" tabindex="-1"></a><span class="do">## Samples were drawn using sampling(NUTS). For each parameter, Bulk_ESS</span></span>
<span id="cb32-24"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb32-24" aria-hidden="true" tabindex="-1"></a><span class="do">## and Tail_ESS are effective sample size measures, and Rhat is the potential</span></span>
<span id="cb32-25"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb32-25" aria-hidden="true" tabindex="-1"></a><span class="do">## scale reduction factor on split chains (at convergence, Rhat = 1).</span></span></code></pre></div>
<p>If we compare the ESS for this new model to the previous model, we see that using 4 chains has substantially increased our ESS, without taking up any more computing time.</p>
<p>One final tweak that I will be using going forward is to ‘thin’ samples. Notice that we have collected <code>total post-warmup samples = 4000</code>. This means our model has 4000 samples for every parameter in the model. However, for some parameter we have only about 400 ‘effective samples’. This means that a lot of our samples are basically dead weight, taking up space and slowing down future computations for no good reason.</p>
<p>The discrepancy between the number of samples and the ‘effective’ number of samples is due to something called <em>autocorrelation</em>. Sometimes consecutive samples can be too similar and so don’t given you that much <em>independent</em> information. When this happens you end up with less information about a parameter than you might think based on the number of samples you have. One way to fix this is to run longer chains and keep only every Nth one. This lets your models be smaller while containing approximately the same information.</p>
<p>To do this you have to change the <code>iter</code>, <code>warmup</code> and <code>thin</code> parameters. You will keep every sample after the warmup is done, up to the <code>iter</code> maximum. So if <code>iter=3000</code> and <code>warmup=1000</code> you will end up with 2000 samples. After this, you keep only one every <code>thin</code> samples. Basically, you will end up with <span class="math inline">\((iter-warmup) / thin\)</span> samples per chain. If you are doing this across <code>Ncores</code> cores, then you will end up with <span class="math inline">\(((iter-warmup) / thin) \times Ncores\)</span> samples in total.</p>
<p>Below, I ask for 11,000 sample per chain. Since the warmup is 1000 this means we will keep 10,000 post warm-up. However, since <code>thin=10</code>, we will keep only 1000 of these. Finally, since we are fitting the model on four cores, we will end up with 4000 samples in total. As a resul, despite having the same number of samples as the <code>multilevel_multicore</code>, the ESS for this model is much higher for important parameters such as the model intercept.</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit the model yourself, or</span></span>
<span id="cb33-2"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb33-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span> (<span class="dv">1</span>)</span>
<span id="cb33-3"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb33-3" aria-hidden="true" tabindex="-1"></a>multilevel_thinned <span class="ot">=</span>  </span>
<span id="cb33-4"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb33-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">brm</span> (f0 <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>speaker), <span class="at">data =</span> w, <span class="at">chains =</span> <span class="dv">4</span>, <span class="at">cores =</span> <span class="dv">4</span>,</span>
<span id="cb33-5"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb33-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">warmup =</span> <span class="dv">1000</span>, <span class="at">iter =</span> <span class="dv">11000</span>, <span class="at">thin =</span> <span class="dv">10</span>)</span>
<span id="cb33-6"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb33-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-7"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb33-7" aria-hidden="true" tabindex="-1"></a><span class="co"># download pre-fit model from: </span></span>
<span id="cb33-8"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb33-8" aria-hidden="true" tabindex="-1"></a><span class="co"># github.com/santiagobarreda/stats-class/tree/master/models</span></span>
<span id="cb33-9"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb33-9" aria-hidden="true" tabindex="-1"></a><span class="co"># and load after placing in working directory</span></span>
<span id="cb33-10"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb33-10" aria-hidden="true" tabindex="-1"></a>multilevel_thinned <span class="ot">=</span> <span class="fu">readRDS</span> (<span class="st">&#39;2_multilevel_thinned.RDS&#39;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="co"># inspect model</span></span>
<span id="cb34-2"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb34-2" aria-hidden="true" tabindex="-1"></a>multilevel_thinned</span>
<span id="cb34-3"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb34-3" aria-hidden="true" tabindex="-1"></a><span class="do">##  Family: gaussian </span></span>
<span id="cb34-4"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb34-4" aria-hidden="true" tabindex="-1"></a><span class="do">##   Links: mu = identity; sigma = identity </span></span>
<span id="cb34-5"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb34-5" aria-hidden="true" tabindex="-1"></a><span class="do">## Formula: f0 ~ 1 + (1 | uspeaker) </span></span>
<span id="cb34-6"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb34-6" aria-hidden="true" tabindex="-1"></a><span class="do">##    Data: w (Number of observations: 576) </span></span>
<span id="cb34-7"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb34-7" aria-hidden="true" tabindex="-1"></a><span class="do">## Samples: 4 chains, each with iter = 11000; warmup = 1000; thin = 10;</span></span>
<span id="cb34-8"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb34-8" aria-hidden="true" tabindex="-1"></a><span class="do">##          total post-warmup samples = 4000</span></span>
<span id="cb34-9"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb34-9" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb34-10"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb34-10" aria-hidden="true" tabindex="-1"></a><span class="do">## Group-Level Effects: </span></span>
<span id="cb34-11"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb34-11" aria-hidden="true" tabindex="-1"></a><span class="do">## ~uspeaker (Number of levels: 48) </span></span>
<span id="cb34-12"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb34-12" aria-hidden="true" tabindex="-1"></a><span class="do">##               Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS</span></span>
<span id="cb34-13"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb34-13" aria-hidden="true" tabindex="-1"></a><span class="do">## sd(Intercept)    20.06      2.23    16.24    24.98 1.00     2775     3392</span></span>
<span id="cb34-14"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb34-14" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb34-15"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb34-15" aria-hidden="true" tabindex="-1"></a><span class="do">## Population-Level Effects: </span></span>
<span id="cb34-16"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb34-16" aria-hidden="true" tabindex="-1"></a><span class="do">##           Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS</span></span>
<span id="cb34-17"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb34-17" aria-hidden="true" tabindex="-1"></a><span class="do">## Intercept   220.40      2.95   214.57   226.19 1.00     1987     2625</span></span>
<span id="cb34-18"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb34-18" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb34-19"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb34-19" aria-hidden="true" tabindex="-1"></a><span class="do">## Family Specific Parameters: </span></span>
<span id="cb34-20"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb34-20" aria-hidden="true" tabindex="-1"></a><span class="do">##       Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS</span></span>
<span id="cb34-21"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb34-21" aria-hidden="true" tabindex="-1"></a><span class="do">## sigma    12.54      0.38    11.81    13.31 1.00     3908     3891</span></span>
<span id="cb34-22"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb34-22" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb34-23"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb34-23" aria-hidden="true" tabindex="-1"></a><span class="do">## Samples were drawn using sampling(NUTS). For each parameter, Bulk_ESS</span></span>
<span id="cb34-24"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb34-24" aria-hidden="true" tabindex="-1"></a><span class="do">## and Tail_ESS are effective sample size measures, and Rhat is the potential</span></span>
<span id="cb34-25"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb34-25" aria-hidden="true" tabindex="-1"></a><span class="do">## scale reduction factor on split chains (at convergence, Rhat = 1).</span></span></code></pre></div>
</div>
<div id="specifying-prior-probabilities" class="section level2" number="2.6">
<h2><span class="header-section-number">2.6</span> Specifying prior probabilities</h2>
<p>In Chapter 1 we discussed that Bayesian models require that prior probabilities be specified for all parameters. You may have noticed that to this point I haven’t discussed priors at all.</p>
<p>If you don’t specify prior probabilities for your parameters, <code>brm</code> will use a ‘flat/uniform’ prior for all parameters. When you do this, you are basically relying only on the likelihood for your analysis. You are also telling your model that, a priori, <em>any</em> value of average f0 is equally believable. Empirically, this is false. As a practical matter this can cause problems for samplers like STAN (which is what <code>brm</code> relies on). Basically, in the absence of proper priors the sampler has a harder time figuring out the most likely values when you tell it to look anywhere from positive to negative infinity. Even a bit of guidance can help.</p>
<p><code>brms</code> makes it really easy to specify prior probabilities for specific parameters or whole groups of parameters. Below, I set priors for whole classes of parameters. In the example below, I use this information to set reasonable bounds on the parameters in the model. I do this by class of parameter:</p>
<ul>
<li><code>Intercept</code>: this is a unique class, only for intercepts.</li>
<li><code>b</code>: this is for all the non-intercept predictors. There are none in this model for now.</li>
<li><code>sd</code>: this is for our standard deviation parameters that relate to ‘batches’ of parameters. In our example this is <code>sd(Intercept)</code> for <code>speaker</code> (<span class="math inline">\(\sigma_{speakers}\)</span>).</li>
<li><code>sigma</code>: this is for any error parameters. Our only has one (but it could have more!), that is <code>sigma</code> (<span class="math inline">\(\sigma_{error}\)</span>).</li>
</ul>
<p>We’re not going to worry about priors too much for now, and we’re just going to set what are called ‘weakly informative’ prior probabilities for our parameters. These are priors that encode a bit of information about our prior beliefes for a parameter, but are not <em>too</em> strong. To set these, you have to use what you know about your variables, the world, and a healthy does of ‘common sense’. We will see a lot of examples of, and strategies for, setting priors in this book so you will get a chance to build your intuitions about it.</p>
<p>Both priors below use a ‘t’ distribution, which is just like a normal distribution but it’s more pointy, and has more density in the outer parts of the distribution. You can use normal priors, or any other priors that you think work for your model. Rather than focusing on the <em>mathematical</em> properties of priors, the most important thing is that their <em>shape</em> reflect the distribution of credible parameter values a priori (before you conducted your experiment).</p>
<p>The code to set the priors for our model looks like this:</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb35-1" aria-hidden="true" tabindex="-1"></a>  prior <span class="ot">=</span> <span class="fu">c</span>(<span class="fu">set_prior</span>(<span class="st">&quot;student_t(3, 220, 50)&quot;</span>, <span class="at">class =</span> <span class="st">&quot;Intercept&quot;</span>),</span>
<span id="cb35-2"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb35-2" aria-hidden="true" tabindex="-1"></a>            <span class="fu">set_prior</span>(<span class="st">&quot;student_t(3, 0, 100)&quot;</span>, <span class="at">class =</span> <span class="st">&quot;sd&quot;</span>),</span>
<span id="cb35-3"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb35-3" aria-hidden="true" tabindex="-1"></a>            <span class="fu">set_prior</span>(<span class="st">&quot;student_t(3, 0, 100)&quot;</span>, <span class="at">class =</span> <span class="st">&quot;sigma&quot;</span>))</span></code></pre></div>
<p>The format for the priors is like this <code>student_t(nu, mean, sd)</code>, where <code>nu</code> is a parameter that determines how pointy the distribution is, and <code>mean</code> and <code>sd</code> are the same mean and standard deviation parameters from the normal distribution. The nu parameter ranges from 1 to infinity, and large numbers result in a more normal-like distribution. We will talk about the t-distribution ins more detail later.</p>
<p>For the overall model intercept we set a prior probability of <code>student_t(3, 220, 110)</code>. Around 90-95% of the distribution of normal and t distributions is within two standard deviations of the mean. This means that I am saying the intercept should be between around 0 and 440 Hz. Since this range is higher than the range of human speaker f0s (about 80-300 Hz), this prior is not going to affect our outcomes very much.</p>
<p>The prior for the speaker standard deviation parameter (<span class="math inline">\(\sigma_{speakers}\)</span>) is <code>student_t(3, 0, 100)</code>, which specifies a t distribution centered at 0, with a standard deviation of 100. Since standard deviations can only be positive, the sampler (STAN) used by <code>brm</code> ignores the negative half, and uses only the positive values in the prior distribution. This prior just says that we expect the average difference between speakers to be less than 200 Hz (which it definitely is).</p>
<p>Finally, the prior for the random error is also <code>student_t(3, 0, 100)</code>. Again, this says that we expect that the standard deviation of our random error to be less than 200 Hz. Since our random error is within-speaker variation, this is a again a massive overestimation of the likely magnitude of the random error in this data.</p>
<p>The left panel below compares the t distribution we used (blue) to the equivalent normal distribution (red). Although it may not seem like much of a difference, the t distribution can tolerate more extreme values because of its ‘fatter’ (more dense) tails. As we will discuss later, using t distributions can make our models more robust to outliers. This is really important in linguistics where subjects/speakers sometimes do weird stuff! As we can see, the prior distribution we used for the intercept is much broader (more vague) than the data distribution so that it will have basically no effect on our results (but will help our model fit properly).</p>
<p>The right panel compares the prior for the standard deviation parameters to the absolute value of the centered f0 data. This presentation shows how far each observation is from the mean f0 (at 220 Hz). Obviously, people can’t differ from each other by more than deviations differ from the mean. As a result, we see that the prior distribution we have assigned for the <code>sigma</code> (i.e., <span class="math inline">\(\sigma_{[speaker]}\)</span>) and speaker <code>sd(Intercept)</code> parameter (i.e., <span class="math inline">\(\sigma_{[speaker]}\)</span>) are much broader than these parameters could be, given the data. As a result, neither of these priors is going to have much of an effect on our parameter estimates.</p>
<div class="figure"><span id="fig:F2-6"></span>
<img src="02_files/figure-html/F2-6-1.png" alt="(left) A comparison of the densities of normal and t distributions with the same means and sigma parameters. The histogram shows our f0 data. (right) The distribution of absolute deviations from the mean for our f0 data, compared to the prior distributions of our standard deviation parameters in our model." width="768" />
<p class="caption">
Figure 2.6: (left) A comparison of the densities of normal and t distributions with the same means and sigma parameters. The histogram shows our f0 data. (right) The distribution of absolute deviations from the mean for our f0 data, compared to the prior distributions of our standard deviation parameters in our model.
</p>
</div>
<p>We can fit this new model below, and inspect the output. If we compare the output of this model to <code>multilevel_thinned</code>, we see that specifying a prior has has no noticeable effect on our results. This is because the prior matters less and less when you have a lot of data, and because we have set wide priors that are appropriate (but vague) given our data. Although the priors may not matter much for models as simple as these, they can be very important when working with more complex data, and are a necessary component of Bayesian modeling.</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit the model yourself, or</span></span>
<span id="cb36-2"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb36-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span> (<span class="dv">1</span>)</span>
<span id="cb36-3"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb36-3" aria-hidden="true" tabindex="-1"></a>multilevel_priors <span class="ot">=</span>  </span>
<span id="cb36-4"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb36-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">brm</span> (f0 <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>speaker), <span class="at">data =</span> w, <span class="at">chains =</span> <span class="dv">4</span>, <span class="at">cores =</span> <span class="dv">4</span>,</span>
<span id="cb36-5"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb36-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">warmup =</span> <span class="dv">1000</span>, <span class="at">iter =</span> <span class="dv">11000</span>, <span class="at">thin =</span> <span class="dv">10</span>,</span>
<span id="cb36-6"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb36-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">prior =</span> <span class="fu">c</span>(<span class="fu">set_prior</span>(<span class="st">&quot;student_t(3, 220, 100)&quot;</span>, <span class="at">class =</span> <span class="st">&quot;Intercept&quot;</span>),</span>
<span id="cb36-7"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb36-7" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">set_prior</span>(<span class="st">&quot;student_t(3, 0, 100)&quot;</span>, <span class="at">class =</span> <span class="st">&quot;sd&quot;</span>),</span>
<span id="cb36-8"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb36-8" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">set_prior</span>(<span class="st">&quot;student_t(3, 0, 100)&quot;</span>, <span class="at">class =</span> <span class="st">&quot;sigma&quot;</span>)))</span>
<span id="cb36-9"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb36-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-10"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb36-10" aria-hidden="true" tabindex="-1"></a><span class="co"># download pre-fit model from: </span></span>
<span id="cb36-11"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb36-11" aria-hidden="true" tabindex="-1"></a><span class="co"># github.com/santiagobarreda/stats-class/tree/master/models</span></span>
<span id="cb36-12"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb36-12" aria-hidden="true" tabindex="-1"></a><span class="co"># and load after placing in working directory</span></span>
<span id="cb36-13"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb36-13" aria-hidden="true" tabindex="-1"></a>multilevel_priors <span class="ot">=</span> <span class="fu">readRDS</span> (<span class="st">&#39;2_multilevel_priors.RDS&#39;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="co"># inspect model</span></span>
<span id="cb37-2"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb37-2" aria-hidden="true" tabindex="-1"></a>multilevel_priors</span>
<span id="cb37-3"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb37-3" aria-hidden="true" tabindex="-1"></a><span class="do">##  Family: gaussian </span></span>
<span id="cb37-4"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb37-4" aria-hidden="true" tabindex="-1"></a><span class="do">##   Links: mu = identity; sigma = identity </span></span>
<span id="cb37-5"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb37-5" aria-hidden="true" tabindex="-1"></a><span class="do">## Formula: f0 ~ 1 + (1 | uspeaker) </span></span>
<span id="cb37-6"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb37-6" aria-hidden="true" tabindex="-1"></a><span class="do">##    Data: w (Number of observations: 576) </span></span>
<span id="cb37-7"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb37-7" aria-hidden="true" tabindex="-1"></a><span class="do">## Samples: 4 chains, each with iter = 11000; warmup = 1000; thin = 10;</span></span>
<span id="cb37-8"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb37-8" aria-hidden="true" tabindex="-1"></a><span class="do">##          total post-warmup samples = 4000</span></span>
<span id="cb37-9"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb37-9" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb37-10"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb37-10" aria-hidden="true" tabindex="-1"></a><span class="do">## Group-Level Effects: </span></span>
<span id="cb37-11"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb37-11" aria-hidden="true" tabindex="-1"></a><span class="do">## ~uspeaker (Number of levels: 48) </span></span>
<span id="cb37-12"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb37-12" aria-hidden="true" tabindex="-1"></a><span class="do">##               Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS</span></span>
<span id="cb37-13"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb37-13" aria-hidden="true" tabindex="-1"></a><span class="do">## sd(Intercept)    20.19      2.24    16.29    25.06 1.00     3114     3663</span></span>
<span id="cb37-14"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb37-14" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb37-15"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb37-15" aria-hidden="true" tabindex="-1"></a><span class="do">## Population-Level Effects: </span></span>
<span id="cb37-16"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb37-16" aria-hidden="true" tabindex="-1"></a><span class="do">##           Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS</span></span>
<span id="cb37-17"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb37-17" aria-hidden="true" tabindex="-1"></a><span class="do">## Intercept   220.42      2.97   214.44   226.38 1.00     1796     2841</span></span>
<span id="cb37-18"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb37-18" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb37-19"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb37-19" aria-hidden="true" tabindex="-1"></a><span class="do">## Family Specific Parameters: </span></span>
<span id="cb37-20"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb37-20" aria-hidden="true" tabindex="-1"></a><span class="do">##       Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS</span></span>
<span id="cb37-21"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb37-21" aria-hidden="true" tabindex="-1"></a><span class="do">## sigma    12.54      0.39    11.81    13.34 1.00     3968     3972</span></span>
<span id="cb37-22"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb37-22" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb37-23"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb37-23" aria-hidden="true" tabindex="-1"></a><span class="do">## Samples were drawn using sampling(NUTS). For each parameter, Bulk_ESS</span></span>
<span id="cb37-24"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb37-24" aria-hidden="true" tabindex="-1"></a><span class="do">## and Tail_ESS are effective sample size measures, and Rhat is the potential</span></span>
<span id="cb37-25"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb37-25" aria-hidden="true" tabindex="-1"></a><span class="do">## scale reduction factor on split chains (at convergence, Rhat = 1).</span></span></code></pre></div>
</div>
<div id="answering-our-research-questions" class="section level2" number="2.7">
<h2><span class="header-section-number">2.7</span> Answering our research questions</h2>
<p>Let’s return to the research questions we posed initially in Chapoter 1, and again at the beginning of this chapter:</p>
<ol style="list-style-type: decimal">
<li><p>What is the average f0 of the whole <em>population</em> likely to be?</p></li>
<li><p>Can we set bounds on likely mean f0 values based on the data we collected?</p></li>
</ol>
<p>And we can compare the answers provided to this question by our initial model (which contained no priors or information about repeated measured) and final models (which contained information about speakers and appropriate priors).</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb38-1" aria-hidden="true" tabindex="-1"></a>model</span>
<span id="cb38-2"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb38-2" aria-hidden="true" tabindex="-1"></a><span class="do">##  Family: gaussian </span></span>
<span id="cb38-3"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb38-3" aria-hidden="true" tabindex="-1"></a><span class="do">##   Links: mu = identity; sigma = identity </span></span>
<span id="cb38-4"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb38-4" aria-hidden="true" tabindex="-1"></a><span class="do">## Formula: f0 ~ 1 </span></span>
<span id="cb38-5"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb38-5" aria-hidden="true" tabindex="-1"></a><span class="do">##    Data: w (Number of observations: 576) </span></span>
<span id="cb38-6"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb38-6" aria-hidden="true" tabindex="-1"></a><span class="do">## Samples: 1 chains, each with iter = 2000; warmup = 1000; thin = 1;</span></span>
<span id="cb38-7"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb38-7" aria-hidden="true" tabindex="-1"></a><span class="do">##          total post-warmup samples = 1000</span></span>
<span id="cb38-8"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb38-8" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb38-9"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb38-9" aria-hidden="true" tabindex="-1"></a><span class="do">## Population-Level Effects: </span></span>
<span id="cb38-10"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb38-10" aria-hidden="true" tabindex="-1"></a><span class="do">##           Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS</span></span>
<span id="cb38-11"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb38-11" aria-hidden="true" tabindex="-1"></a><span class="do">## Intercept   220.40      0.97   218.33   222.30 1.00      851      557</span></span>
<span id="cb38-12"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb38-12" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb38-13"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb38-13" aria-hidden="true" tabindex="-1"></a><span class="do">## Family Specific Parameters: </span></span>
<span id="cb38-14"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb38-14" aria-hidden="true" tabindex="-1"></a><span class="do">##       Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS</span></span>
<span id="cb38-15"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb38-15" aria-hidden="true" tabindex="-1"></a><span class="do">## sigma    23.24      0.69    21.99    24.61 1.00      653      550</span></span>
<span id="cb38-16"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb38-16" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb38-17"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb38-17" aria-hidden="true" tabindex="-1"></a><span class="do">## Samples were drawn using sampling(NUTS). For each parameter, Bulk_ESS</span></span>
<span id="cb38-18"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb38-18" aria-hidden="true" tabindex="-1"></a><span class="do">## and Tail_ESS are effective sample size measures, and Rhat is the potential</span></span>
<span id="cb38-19"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb38-19" aria-hidden="true" tabindex="-1"></a><span class="do">## scale reduction factor on split chains (at convergence, Rhat = 1).</span></span>
<span id="cb38-20"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb38-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-21"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb38-21" aria-hidden="true" tabindex="-1"></a>multilevel_priors</span>
<span id="cb38-22"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb38-22" aria-hidden="true" tabindex="-1"></a><span class="do">##  Family: gaussian </span></span>
<span id="cb38-23"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb38-23" aria-hidden="true" tabindex="-1"></a><span class="do">##   Links: mu = identity; sigma = identity </span></span>
<span id="cb38-24"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb38-24" aria-hidden="true" tabindex="-1"></a><span class="do">## Formula: f0 ~ 1 + (1 | uspeaker) </span></span>
<span id="cb38-25"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb38-25" aria-hidden="true" tabindex="-1"></a><span class="do">##    Data: w (Number of observations: 576) </span></span>
<span id="cb38-26"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb38-26" aria-hidden="true" tabindex="-1"></a><span class="do">## Samples: 4 chains, each with iter = 11000; warmup = 1000; thin = 10;</span></span>
<span id="cb38-27"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb38-27" aria-hidden="true" tabindex="-1"></a><span class="do">##          total post-warmup samples = 4000</span></span>
<span id="cb38-28"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb38-28" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb38-29"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb38-29" aria-hidden="true" tabindex="-1"></a><span class="do">## Group-Level Effects: </span></span>
<span id="cb38-30"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb38-30" aria-hidden="true" tabindex="-1"></a><span class="do">## ~uspeaker (Number of levels: 48) </span></span>
<span id="cb38-31"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb38-31" aria-hidden="true" tabindex="-1"></a><span class="do">##               Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS</span></span>
<span id="cb38-32"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb38-32" aria-hidden="true" tabindex="-1"></a><span class="do">## sd(Intercept)    20.19      2.24    16.29    25.06 1.00     3114     3663</span></span>
<span id="cb38-33"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb38-33" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb38-34"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb38-34" aria-hidden="true" tabindex="-1"></a><span class="do">## Population-Level Effects: </span></span>
<span id="cb38-35"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb38-35" aria-hidden="true" tabindex="-1"></a><span class="do">##           Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS</span></span>
<span id="cb38-36"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb38-36" aria-hidden="true" tabindex="-1"></a><span class="do">## Intercept   220.42      2.97   214.44   226.38 1.00     1796     2841</span></span>
<span id="cb38-37"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb38-37" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb38-38"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb38-38" aria-hidden="true" tabindex="-1"></a><span class="do">## Family Specific Parameters: </span></span>
<span id="cb38-39"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb38-39" aria-hidden="true" tabindex="-1"></a><span class="do">##       Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS</span></span>
<span id="cb38-40"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb38-40" aria-hidden="true" tabindex="-1"></a><span class="do">## sigma    12.54      0.39    11.81    13.34 1.00     3968     3972</span></span>
<span id="cb38-41"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb38-41" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb38-42"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb38-42" aria-hidden="true" tabindex="-1"></a><span class="do">## Samples were drawn using sampling(NUTS). For each parameter, Bulk_ESS</span></span>
<span id="cb38-43"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb38-43" aria-hidden="true" tabindex="-1"></a><span class="do">## and Tail_ESS are effective sample size measures, and Rhat is the potential</span></span>
<span id="cb38-44"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb38-44" aria-hidden="true" tabindex="-1"></a><span class="do">## scale reduction factor on split chains (at convergence, Rhat = 1).</span></span></code></pre></div>
<p>Our initial model (<code>model</code>) and our final model (<code>multilevel_priors</code>) agree on what the average f0 is. However, they disagree on a credible interval for that parameter. Our initial model did not specify information about repeated measures. This causes our model to think that it has more independent observations than it does, and so it returns an overly-precise estimate.</p>
<p>Another difference is that the final model has a much smaller <code>sigma</code> parameter (12.5 vs 23.2). This indicates that the error (<span class="math inline">\(\varepsilon\)</span>) is much smaller in the final model than in the initial model. Keep in mind that ‘error’ is just what your model can’t explain. Our final model explains much more and so there is less error. The reduced error is a direct consequence of the fact that the final model splits the variation in the data into between-speaker and within-speaker components (i.e., <span class="math inline">\(\sigma_{total}=\sigma_{speaker}+\sigma_{error}\)</span>), estimating the between-speaker variation (<span class="math inline">\(\sigma_{speaker}\)</span>) to be about 20 Hz. Since <span class="math inline">\(\sigma_{total}\)</span> is a fixed value (given the data), obviously the larger your between-speaker variation is (<span class="math inline">\(\sigma_{speaker}\)</span>), the smaller your random error ((<span class="math inline">\(\sigma_{error}\)</span>)) <em>must</em> be.</p>
<p>Usually, when I report parameters I provide the mean and standard deviations of the posterior distribution, in addition to the bounds of the 95% credible interval of the parameter. Based on the result of our final model, I think a thorough description of the general properties of our data might go something like:</p>
<blockquote>
<p>"Based on our model the average f0 produced by adult females in Michigan is likely to be 220 Hz (s.d. = 2.97, 95% CI = 214.4, 226.4). However, consistent between-speaker variation averages about 20 Hz (s.d. = 2.24, 95% CI = 16.29, 25.06), meaning that we can expect the average f0 produced by individuals to deviate substantially from 220 Hz. Finally, the standard deviation of production error was about 12.5 Hz (s.d. = 0.39, 95% CI = 11.81, 13.34) indicating that the amount of random within-speaker variation in production is about half the magnitude of the systematic between-speaker differences in f0.</p>
</blockquote>
<p>I’m again including the speaker boxplots below because I think this image basically presents the same information as the paragraph above, but in visual form. In general, any data relationship or result can be presented in a figure, and the relationships presented in a figure can also be expressed as a mathematical model.</p>
<p>When you are thinking about the relationships in your data, or that you expect in your data, its a good idea to think: what kind of picture could illustrate this relationship? Conversely, if you see a figure of your results that you feel really expresses something interesting about your data you should think, how can these relationships be represented in a model?</p>
<div class="figure"><span id="fig:F2-7"></span>
<img src="02_files/figure-html/F2-7-1.png" alt="Speaker-specific boxplots for the f0 data." width="768" />
<p class="caption">
Figure 2.7: Speaker-specific boxplots for the f0 data.
</p>
</div>
</div>
<div id="simulating-data-using-our-model-parameters" class="section level2" number="2.8">
<h2><span class="header-section-number">2.8</span> Simulating data using our model parameters</h2>
<p>One way to think about what all these numbers mean is to simulate data that has the same characteristics, and build fake data from the individual component parts. The code chunk below does exactly this for the data we have been discussing thus far.</p>
<p>First, there is an intercept equal to 220.4 Hz. Then, I create effects representing 48 simulated ‘female talkers’ from a population just like our observed population. These effects are stored in a vector called <code>alpha_speaker</code>, and they represent the values of <span class="math inline">\(\alpha_{speaker}\)</span> for our different speakers. These speaker effects come from a population with a mean of 0 and a standard deviation (<span class="math inline">\(\sigma_{speaker}\)</span>) equal to 20.4 (like our data). Each of these simulated speakers produces 12 productions, and so we need a <code>speakers</code> vector with values that repeat 12 times each to index the <code>alpha_speaker</code> vector containing the effects.</p>
<p>I also draw our error, <span class="math inline">\(\varepsilon\)</span>. This error comes from a distribution with a mean of 0 and a standard deviation equal to <span class="math inline">\(\sigma_{error}\)</span>. It’s important to note that the error is just 48x12 random draws from this population. There is no distinction between one person’s productions and another when it comes to the error. If there were, this would indicate differences in sigma between speakers! Our model assumes a single error population for all speakers (but it doesn’t <em>have</em> to be this way).</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="do">## don&#39;t run this line if you want a new simulated dataset. </span></span>
<span id="cb39-2"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb39-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">5</span>)</span>
<span id="cb39-3"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb39-3" aria-hidden="true" tabindex="-1"></a><span class="do">## this is the value of our intercept</span></span>
<span id="cb39-4"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb39-4" aria-hidden="true" tabindex="-1"></a>Intercept <span class="ot">=</span> <span class="fl">220.4</span></span>
<span id="cb39-5"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb39-5" aria-hidden="true" tabindex="-1"></a><span class="do">## this is a vector of 48 speaker effects</span></span>
<span id="cb39-6"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb39-6" aria-hidden="true" tabindex="-1"></a>alpha_speaker <span class="ot">=</span> <span class="fu">rnorm</span> (<span class="dv">48</span>, <span class="dv">0</span>, <span class="fl">20.2</span>)</span>
<span id="cb39-7"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb39-7" aria-hidden="true" tabindex="-1"></a><span class="do">## this is a vector indicating which speaker produced which utterance</span></span>
<span id="cb39-8"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb39-8" aria-hidden="true" tabindex="-1"></a>speaker <span class="ot">=</span> <span class="fu">rep</span> (<span class="dv">1</span><span class="sc">:</span><span class="dv">48</span>, <span class="at">each =</span> <span class="dv">12</span>)</span>
<span id="cb39-9"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb39-9" aria-hidden="true" tabindex="-1"></a><span class="do">## this vector contains the error</span></span>
<span id="cb39-10"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb39-10" aria-hidden="true" tabindex="-1"></a>epsilon <span class="ot">=</span> <span class="fu">rnorm</span> (<span class="dv">48</span> <span class="sc">*</span> <span class="dv">12</span>, <span class="dv">0</span>, <span class="fl">12.5</span>)</span></code></pre></div>
<p>After creating our components, we add the Intercept, speaker deflections and random error to make our fake ‘replicated’ data. Since this data has the same statistical properties as our real data, it should look a lot like it.</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="co"># the sum of an intercept, speaker deflections and random error makes our fake data</span></span>
<span id="cb40-2"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb40-2" aria-hidden="true" tabindex="-1"></a>f0_rep <span class="ot">=</span> Intercept <span class="sc">+</span> alpha_speaker[speaker] <span class="sc">+</span> epsilon</span></code></pre></div>
<p>Below I compare the results of our simulation to our real data. If you didn’t have a clear impression of what the data looked like, I doubt you could tell which is the real data. This tells us our model is a good reflection of the data!</p>
<div class="figure"><span id="fig:F2-8"></span>
<img src="02_files/figure-html/F2-8-1.png" alt="Comparison of real and simulated f0 production data." width="768" />
<p class="caption">
Figure 2.8: Comparison of real and simulated f0 production data.
</p>
</div>
<p>Below I make two datasets that are ‘incomplete’ with respect to the variation in our data. The first contains the intercept and noise only, the second contains the intercept and speaker effects only.</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="co"># this fake data is missing between speaker variation</span></span>
<span id="cb41-2"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb41-2" aria-hidden="true" tabindex="-1"></a>f0_rep_1 <span class="ot">=</span> Intercept <span class="sc">+</span> epsilon</span>
<span id="cb41-3"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb41-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-4"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb41-4" aria-hidden="true" tabindex="-1"></a><span class="co"># this fake data is missing within speaker variation</span></span>
<span id="cb41-5"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb41-5" aria-hidden="true" tabindex="-1"></a>f0_rep_2 <span class="ot">=</span> Intercept <span class="sc">+</span> alpha_speaker[speaker]</span></code></pre></div>
<p>In the figure below, I compare these ‘incomplete’ datasets to the full simulated data. The top row contains only error (<span class="math inline">\(\varepsilon, \sigma_{error}\)</span>). As a result, f0 varies around the intercept, but there is no speaker to speaker variation. This is what that data would look like if there is no random variation in means across subjects.</p>
<p>However, notice that each little box is not centered at 0. Although the error distribution is centered at 0, the small number of errors added to the speaker mean are <strong>extremely</strong> unlikely to add up to exactly 0. So, error contributes some unknown amount to each speaker’s apparent average. This makes estimations of the <em>real</em> speaker effects impossible in practice.</p>
<p>In the middle plot, the figure shows only between-speaker variation (<span class="math inline">\(\alpha_{speaker}, \sigma_{speaker}\)</span>) but no within-speaker variation (i.e., no noise/error). Now we see that speakers vary from the intercept, but this representation does not show the fact that speakers also vary relative to their own average.</p>
<p>The final plot is the combination of the variation in the top two figures. The final plot shows the simulated data: the sum of the intercept, the within speaker variation and the between-speaker variation reflected in the values of the speaker intercepts.</p>
<div class="figure" style="text-align: center"><span id="fig:F2-9"></span>
<img src="02_files/figure-html/F2-9-1.png" alt="(top) Simulated error variation around the intercept. (middle) Simulated between-speaker variation, but no production error. (bottom) Simulated data containing both within and between-speaker variation in f0." width="672" />
<p class="caption">
Figure 2.9: (top) Simulated error variation around the intercept. (middle) Simulated between-speaker variation, but no production error. (bottom) Simulated data containing both within and between-speaker variation in f0.
</p>
</div>
</div>
<div id="frequentist-corner" class="section level2" number="2.9">
<h2><span class="header-section-number">2.9</span> Frequentist corner</h2>
<p>We’re going to compare the output of <code>brms</code> to some more ‘traditional’ approaches. I’m not going to talk about the traditional models in any detail, the focus of this section is simply to highlight the similarities between different approaches, and to point out where to find equivalent information in the different models. As a result, this section will mostly be useful for people familiar with the traditional approaches.</p>
<div id="bayesian-multilevel-modesl-vs.-lmer" class="section level3" number="2.9.1">
<h3><span class="header-section-number">2.9.1</span> Bayesian multilevel modesl vs. lmer</h3>
<p>First, we will compare the output of our multilevel Bayesian modesl to the output of the <code>lmer</code> (“linear mixed-effects regression”) function, a very popular function for fitting multilevel models in the <code>lme4</code> R package.</p>
<p>Below we fit a model just like our <code>multilevel_priors</code> model. Note that the model syntax is identical and that, actually, the whole function call is quite similar to how we would fit the model using <code>brm</code>. This is a good thing, it means that much of the material we use in this book can also be used to work with the <code>lmer</code> function, should you find this more convenient.</p>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span> (lme4)</span>
<span id="cb42-2"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb42-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-3"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb42-3" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span> (<span class="dv">1</span>)</span>
<span id="cb42-4"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb42-4" aria-hidden="true" tabindex="-1"></a>lmer_model <span class="ot">=</span> <span class="fu">lmer</span> (f0 <span class="sc">~</span> (<span class="dv">1</span><span class="sc">|</span>speaker), <span class="at">data =</span> w)</span></code></pre></div>
<p>Below I’ve annotated the print statements for the equivalent <code>lmer</code> and <code>brm</code> models, and provide explanations for each section below.</p>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="co"># print model summary</span></span>
<span id="cb43-2"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb43-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span> (lmer_model)</span>
<span id="cb43-3"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb43-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-4"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb43-4" aria-hidden="true" tabindex="-1"></a><span class="do">## (1) Linear mixed model fit by REML [&#39;lmerMod&#39;]</span></span>
<span id="cb43-5"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb43-5" aria-hidden="true" tabindex="-1"></a><span class="do">## (1) Formula: f0 ~ (1 | speaker)</span></span>
<span id="cb43-6"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb43-6" aria-hidden="true" tabindex="-1"></a><span class="do">## (1) Data: w</span></span>
<span id="cb43-7"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb43-7" aria-hidden="true" tabindex="-1"></a><span class="do">## (1) </span></span>
<span id="cb43-8"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb43-8" aria-hidden="true" tabindex="-1"></a><span class="do">## (1) REML criterion at convergence: 4705.8</span></span>
<span id="cb43-9"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb43-9" aria-hidden="true" tabindex="-1"></a><span class="do">## (1)</span></span>
<span id="cb43-10"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb43-10" aria-hidden="true" tabindex="-1"></a><span class="do">## (1) Scaled residuals: </span></span>
<span id="cb43-11"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb43-11" aria-hidden="true" tabindex="-1"></a><span class="do">## (1)     Min      1Q  Median      3Q     Max </span></span>
<span id="cb43-12"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb43-12" aria-hidden="true" tabindex="-1"></a><span class="do">## (1) -4.3792 -0.5962 -0.1005  0.4771  3.9273 </span></span>
<span id="cb43-13"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb43-13" aria-hidden="true" tabindex="-1"></a><span class="do">##  </span></span>
<span id="cb43-14"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb43-14" aria-hidden="true" tabindex="-1"></a><span class="do">##     Random effects:</span></span>
<span id="cb43-15"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb43-15" aria-hidden="true" tabindex="-1"></a><span class="do">##      Groups   Name        Variance Std.Dev.</span></span>
<span id="cb43-16"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb43-16" aria-hidden="true" tabindex="-1"></a><span class="do">## (2)  speaker  (Intercept) 389.9    19.75   </span></span>
<span id="cb43-17"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb43-17" aria-hidden="true" tabindex="-1"></a><span class="do">## (3)  Residual             156.8    12.52   </span></span>
<span id="cb43-18"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb43-18" aria-hidden="true" tabindex="-1"></a><span class="do">##     Number of obs: 576, groups:  speaker, 48</span></span>
<span id="cb43-19"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb43-19" aria-hidden="true" tabindex="-1"></a><span class="do">##  </span></span>
<span id="cb43-20"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb43-20" aria-hidden="true" tabindex="-1"></a><span class="do">##     Fixed effects:</span></span>
<span id="cb43-21"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb43-21" aria-hidden="true" tabindex="-1"></a><span class="do">##                 Estimate Std. Error t value</span></span>
<span id="cb43-22"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb43-22" aria-hidden="true" tabindex="-1"></a><span class="do">## (4) (Intercept)  220.401      2.897   76.07</span></span></code></pre></div>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb44-1" aria-hidden="true" tabindex="-1"></a>multilevel_priors</span>
<span id="cb44-2"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb44-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-3"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb44-3" aria-hidden="true" tabindex="-1"></a><span class="do">## (1)  Family: gaussian </span></span>
<span id="cb44-4"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb44-4" aria-hidden="true" tabindex="-1"></a><span class="do">## (1)   Links: mu = identity; sigma = identity </span></span>
<span id="cb44-5"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb44-5" aria-hidden="true" tabindex="-1"></a><span class="do">## (1) Formula: f0 ~ 1 + (1 | speaker) </span></span>
<span id="cb44-6"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb44-6" aria-hidden="true" tabindex="-1"></a><span class="do">## (1)    Data: w (Number of observations: 576) </span></span>
<span id="cb44-7"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb44-7" aria-hidden="true" tabindex="-1"></a><span class="do">## (1) Samples: 4 chains, each with iter = 11000; warmup = 1000; thin = 10;</span></span>
<span id="cb44-8"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb44-8" aria-hidden="true" tabindex="-1"></a><span class="do">## (1)          total post-warmup samples = 4000</span></span>
<span id="cb44-9"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb44-9" aria-hidden="true" tabindex="-1"></a><span class="do">##  </span></span>
<span id="cb44-10"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb44-10" aria-hidden="true" tabindex="-1"></a><span class="do">##     Group-Level Effects: </span></span>
<span id="cb44-11"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb44-11" aria-hidden="true" tabindex="-1"></a><span class="do">## (2) ~speaker (Number of levels: 48) </span></span>
<span id="cb44-12"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb44-12" aria-hidden="true" tabindex="-1"></a><span class="do">## (2)               Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS</span></span>
<span id="cb44-13"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb44-13" aria-hidden="true" tabindex="-1"></a><span class="do">## (2) sd(Intercept)    20.32      2.23    16.44    25.32 1.00     2777     3254</span></span>
<span id="cb44-14"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb44-14" aria-hidden="true" tabindex="-1"></a><span class="do">##  </span></span>
<span id="cb44-15"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb44-15" aria-hidden="true" tabindex="-1"></a><span class="do">##     Population-Level Effects: </span></span>
<span id="cb44-16"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb44-16" aria-hidden="true" tabindex="-1"></a><span class="do">##               Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS</span></span>
<span id="cb44-17"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb44-17" aria-hidden="true" tabindex="-1"></a><span class="do">## (4) Intercept   220.38      3.00   214.55   226.18 1.00     1639     2497</span></span>
<span id="cb44-18"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb44-18" aria-hidden="true" tabindex="-1"></a><span class="do">##  </span></span>
<span id="cb44-19"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb44-19" aria-hidden="true" tabindex="-1"></a><span class="do">## (3) Family Specific Parameters: </span></span>
<span id="cb44-20"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb44-20" aria-hidden="true" tabindex="-1"></a><span class="do">## (3)        Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS</span></span>
<span id="cb44-21"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb44-21" aria-hidden="true" tabindex="-1"></a><span class="do">## (3) sigma    12.55      0.38    11.83    13.32 1.00     3963     3892</span></span>
<span id="cb44-22"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb44-22" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb44-23"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb44-23" aria-hidden="true" tabindex="-1"></a><span class="do">## (5) Samples were drawn using sampling(NUTS). For each parameter, Bulk_ESS</span></span>
<span id="cb44-24"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb44-24" aria-hidden="true" tabindex="-1"></a><span class="do">## (5) and Tail_ESS are effective sample size measures, and Rhat is the potential</span></span>
<span id="cb44-25"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb44-25" aria-hidden="true" tabindex="-1"></a><span class="do">## (5) scale reduction factor on split chains (at convergence, Rhat = 1).</span></span></code></pre></div>
<p>Section (1) contains basic information about data and model structure, and is unique to each function. Generally, you won’t pay much attention to this section when you use either function, but it does contain useful basic information about your model.</p>
<p>Section (2) in the <code>lmer</code> output presents the variance (389.9) and standard deviation (19.75) of the speaker effects (<span class="math inline">\(\alpha_{[speaker]}\)</span>). Notice that in the equivalent section, <code>brm</code> gives you a mean (20.32) of a very similar values. However, unlike <code>lmer</code> which only returns what are called ‘point estimates’, <code>brm</code> also gives you a credible interval around this parameter estimate. So, only <code>brm</code> tells you about a range of believable values, in addition to telling you the <em>most</em> believable value.</p>
<p>Section (3) in <code>lmer</code> presents the variance (156.8) and standard deviation (12.52) of the <code>Residual</code>, which is what is calls the random error. In section (2) in the <code>brms</code> output we that the error is called <code>sigma</code>, although the estimate is about the same (12.55). Just as with the between-speaker variation about, <code>brm</code> returns an interval for this parameter while <code>lmer</code> returns only a point estimate.</p>
<p>In section (4) <code>lmer</code> and <code>brm</code> presents the model intercept. We see that the <code>Std. Error</code> estimate provided by <code>lmer</code> (2.897) corresponds closely to the standard deviation of the posterior distribution of the intercept parameter provided by <code>brm</code> (3.00). In addition, <code>brm</code> provides an interval around the intercept whereas <code>lmer</code> does not. Finally, in section (5) <code>brm</code> presnts some boilerplate that will look almost the same every time you fit a model.</p>
<p>In general, we see that <code>lmer</code> provides a subset of the information provided by <code>brm</code>, and that the two approaches provide basically the same values for estimates. This is because in both cases, results are being dominated by the likelihoods of different parameters. Although iit is to be expectem it is still reassuring, we woulnd’t want there to be huge differences in our results just by being ‘Bayesian’.</p>
</div>
<div id="bayesian-multilevel-modesl-vs.-the-one-sample-t-test" class="section level3" number="2.9.2">
<h3><span class="header-section-number">2.9.2</span> Bayesian multilevel modesl vs. the one-sample t-test</h3>
<p>We can fit a one-sample t-test to our f0 vector.</p>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span> (w<span class="sc">$</span>f0)</span></code></pre></div>
<pre><code>## 
##  One Sample t-test
## 
## data:  w$f0
## t = 227.8, df = 575, p-value &lt; 2.2e-16
## alternative hypothesis: true mean is not equal to 0
## 95 percent confidence interval:
##  218.5007 222.3014
## sample estimates:
## mean of x 
##   220.401</code></pre>
<p>This usage is incorrect however, since this test requires that all the observations be independent from each other. Since we have 12 samples per speaker, these are not independent of each other. Notice however that the interval provided around the mean (<code>95 percent confidence interval: 218.5007 222.3014</code>) corresponds very well to the interval around the intercept provided by our initial model above (<code>218.33   222.30</code>). The reason they align so well is because they both (inappropriately) treated all our observations as independent.</p>
<p>Below we use the one-sample t-test appropriately. We find the average for each speaker, and then use only those 48 values in our test.</p>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb47-1" aria-hidden="true" tabindex="-1"></a>speaker_means <span class="ot">=</span> <span class="fu">aggregate</span> (f0 <span class="sc">~</span> speaker, <span class="at">data =</span> w, <span class="at">FUN =</span> mean) </span>
<span id="cb47-2"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb47-2" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span> (speaker_means<span class="sc">$</span>f0)</span></code></pre></div>
<pre><code>## 
##  One Sample t-test
## 
## data:  speaker_means$f0
## t = 76.068, df = 47, p-value &lt; 2.2e-16
## alternative hypothesis: true mean is not equal to 0
## 95 percent confidence interval:
##  214.5722 226.2299
## sample estimates:
## mean of x 
##   220.401</code></pre>
<p>Now the interval provided closely resembles that of our final, <code>multilevel_priors</code> model (<code>214.55   226.18</code>). So, if all we care about is estimating a mean and credible interval around the mean, then a one-sample t-test will help us do that. However, our <code>multilevel_priors</code> clearly provides us with substantially more information than is returned by the t-test.</p>
</div>
</div>
<div id="exercises-1" class="section level2" number="2.10">
<h2><span class="header-section-number">2.10</span> Exercises</h2>
<ol style="list-style-type: decimal">
<li><p>Use the code below to fit the final model we considered to the f0s produced by another group of speakers. See if you can get all of the same information out of the model that we considered above. Make a plot of this new data using the plot code provided.</p></li>
<li><p>See if you can use the information from your new data to update the simulated data created above. This entails finding the intercept, within-speaker, and between-speaker variation estimates in your new data and using this to generate a new batch of fake/replicated data.</p></li>
<li><p>Use the code below to fit the model below to your own data. Remember, this data should come from a single group of speakers/participants who each produce one or more data points. You will need to change <code>f0</code> and <code>speaker</code> in the model below to match the names of the columns containing this information in your data. You may also need to change the priors based on the ranges of your variables. If in doubt, you can just set all the priors to have means of 0 and standard deviations of 10,000 for now.</p></li>
</ol>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Get data from course website</span></span>
<span id="cb49-2"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb49-2" aria-hidden="true" tabindex="-1"></a>url1 <span class="ot">=</span> <span class="st">&quot;https://raw.githubusercontent.com/santiagobarreda&quot;</span></span>
<span id="cb49-3"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb49-3" aria-hidden="true" tabindex="-1"></a>url2 <span class="ot">=</span> <span class="st">&quot;/stats-class/master/data/h95_vowel_data.csv&quot;</span></span>
<span id="cb49-4"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb49-4" aria-hidden="true" tabindex="-1"></a>h95 <span class="ot">=</span> <span class="fu">read.csv</span> (<span class="fu">url</span>(<span class="fu">paste0</span> (url1, url2)))</span>
<span id="cb49-5"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb49-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-6"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb49-6" aria-hidden="true" tabindex="-1"></a><span class="co"># uncomment only one of the options below</span></span>
<span id="cb49-7"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb49-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-8"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb49-8" aria-hidden="true" tabindex="-1"></a><span class="co"># select women only</span></span>
<span id="cb49-9"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb49-9" aria-hidden="true" tabindex="-1"></a><span class="co"># f0_data = h95[h95$group == &#39;w&#39;,]</span></span>
<span id="cb49-10"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb49-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-11"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb49-11" aria-hidden="true" tabindex="-1"></a><span class="co"># select boys only</span></span>
<span id="cb49-12"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb49-12" aria-hidden="true" tabindex="-1"></a><span class="co"># f0_data = h95[h95$group == &#39;b&#39;,]</span></span>
<span id="cb49-13"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb49-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-14"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb49-14" aria-hidden="true" tabindex="-1"></a><span class="co"># select girls only</span></span>
<span id="cb49-15"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb49-15" aria-hidden="true" tabindex="-1"></a><span class="co"># f0_data = h95[h95$group == &#39;g&#39;,]</span></span>
<span id="cb49-16"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb49-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-17"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb49-17" aria-hidden="true" tabindex="-1"></a><span class="co"># select men only</span></span>
<span id="cb49-18"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb49-18" aria-hidden="true" tabindex="-1"></a><span class="co"># f0_data = h95[h95$group == &#39;m&#39;,]</span></span>
<span id="cb49-19"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb49-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-20"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb49-20" aria-hidden="true" tabindex="-1"></a>exercise_model <span class="ot">=</span>  </span>
<span id="cb49-21"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb49-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">brm</span> (f0 <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>speaker), <span class="at">data =</span> f0_data, <span class="at">chains =</span> <span class="dv">4</span>, <span class="at">cores =</span> <span class="dv">4</span>,</span>
<span id="cb49-22"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb49-22" aria-hidden="true" tabindex="-1"></a>       <span class="at">warmup =</span> <span class="dv">1000</span>, <span class="at">iter =</span> <span class="dv">11000</span>, <span class="at">thin =</span> <span class="dv">10</span>,</span>
<span id="cb49-23"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb49-23" aria-hidden="true" tabindex="-1"></a>       <span class="at">prior =</span> <span class="fu">c</span>(<span class="fu">set_prior</span>(<span class="st">&quot;student_t(3, 220, 100)&quot;</span>, <span class="at">class =</span> <span class="st">&quot;Intercept&quot;</span>),</span>
<span id="cb49-24"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb49-24" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">set_prior</span>(<span class="st">&quot;student_t(3, 0, 100)&quot;</span>, <span class="at">class =</span> <span class="st">&quot;sd&quot;</span>),</span>
<span id="cb49-25"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb49-25" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">set_prior</span>(<span class="st">&quot;student_t(3, 0, 100)&quot;</span>, <span class="at">class =</span> <span class="st">&quot;sigma&quot;</span>)))</span></code></pre></div>
</div>
<div id="plot-code-1" class="section level2" number="2.11">
<h2><span class="header-section-number">2.11</span> Plot Code</h2>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="do">################################################################################</span></span>
<span id="cb50-2"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb50-2" aria-hidden="true" tabindex="-1"></a><span class="do">### Figure 2.1</span></span>
<span id="cb50-3"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb50-3" aria-hidden="true" tabindex="-1"></a><span class="do">################################################################################</span></span>
<span id="cb50-4"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb50-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-5"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb50-5" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span> (<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>), <span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">4</span>,<span class="dv">4</span>,<span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb50-6"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb50-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-7"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb50-7" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span> (samples[,<span class="dv">1</span>], <span class="at">xlab =</span> <span class="st">&#39;Sample number&#39;</span>,<span class="at">ylab =</span> <span class="st">&#39;f0&#39;</span>,<span class="at">col=</span>teal,<span class="at">pch=</span><span class="dv">16</span>)</span>
<span id="cb50-8"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb50-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-9"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb50-9" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span> (samples[,<span class="dv">1</span>], <span class="at">freq =</span> <span class="cn">FALSE</span>, <span class="at">breaks =</span> <span class="dv">20</span>,<span class="at">main=</span><span class="st">&#39;&#39;</span>,<span class="at">xlab=</span><span class="st">&#39;f0&#39;</span>,<span class="at">col=</span>maroon)</span>
<span id="cb50-10"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb50-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-11"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb50-11" aria-hidden="true" tabindex="-1"></a><span class="fu">curve</span> (<span class="fu">dnorm</span> (x, <span class="fu">mean</span> (f0), <span class="fu">sd</span> (f0) <span class="sc">/</span> <span class="fu">sqrt</span> (<span class="fu">length</span> (f0) )), <span class="at">add =</span> <span class="cn">TRUE</span>,</span>
<span id="cb50-12"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb50-12" aria-hidden="true" tabindex="-1"></a>       <span class="at">lwd =</span> <span class="dv">4</span>, <span class="at">col =</span> yellow)</span>
<span id="cb50-13"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb50-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-14"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb50-14" aria-hidden="true" tabindex="-1"></a><span class="do">################################################################################</span></span>
<span id="cb50-15"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb50-15" aria-hidden="true" tabindex="-1"></a><span class="do">### Figure 2.2</span></span>
<span id="cb50-16"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb50-16" aria-hidden="true" tabindex="-1"></a><span class="do">################################################################################</span></span>
<span id="cb50-17"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb50-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-18"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb50-18" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span> (<span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">4</span>,<span class="dv">4</span>,<span class="dv">2</span>,<span class="dv">1</span>)); <span class="fu">layout</span> (<span class="at">mat =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>), <span class="at">heights =</span> <span class="fu">c</span>(.<span class="dv">3</span>,.<span class="dv">7</span>))</span>
<span id="cb50-19"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb50-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-20"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb50-20" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span> (f0, <span class="at">main =</span> <span class="st">&quot;Overall Boxplot&quot;</span>, <span class="at">col=</span><span class="st">&quot;lavender&quot;</span>, </span>
<span id="cb50-21"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb50-21" aria-hidden="true" tabindex="-1"></a>         <span class="at">horizontal =</span> <span class="cn">TRUE</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">140</span>,<span class="dv">320</span>)) </span>
<span id="cb50-22"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb50-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-23"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb50-23" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span> (f0 <span class="sc">~</span> speaker, <span class="at">data =</span> w, <span class="at">main =</span> <span class="st">&quot;Speaker Boxplots&quot;</span>, <span class="at">col=</span><span class="fu">c</span>(yellow,coral,</span>
<span id="cb50-24"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb50-24" aria-hidden="true" tabindex="-1"></a>         deepgreen,teal), <span class="at">horizontal =</span> <span class="cn">TRUE</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">140</span>,<span class="dv">320</span>)) </span>
<span id="cb50-25"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb50-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-26"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb50-26" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span> (<span class="at">h =</span> <span class="fl">220.4</span>,<span class="at">lty=</span><span class="dv">3</span>,<span class="at">col=</span><span class="st">&#39;grey&#39;</span>,<span class="at">lwd=</span><span class="dv">2</span>)</span>
<span id="cb50-27"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb50-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-28"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb50-28" aria-hidden="true" tabindex="-1"></a><span class="do">################################################################################</span></span>
<span id="cb50-29"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb50-29" aria-hidden="true" tabindex="-1"></a><span class="do">### Figure 2.3</span></span>
<span id="cb50-30"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb50-30" aria-hidden="true" tabindex="-1"></a><span class="do">################################################################################</span></span>
<span id="cb50-31"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb50-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-32"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb50-32" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span> (<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>), <span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">4</span>,<span class="dv">4</span>,<span class="dv">3</span>,<span class="dv">1</span>))</span>
<span id="cb50-33"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb50-33" aria-hidden="true" tabindex="-1"></a>graphics<span class="sc">::</span><span class="fu">layout</span> (<span class="at">mat =</span> <span class="fu">t</span>(<span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>)),<span class="at">widths =</span> <span class="fu">c</span>(.<span class="dv">25</span>,.<span class="dv">5</span>,.<span class="dv">25</span>))</span>
<span id="cb50-34"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb50-34" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span> (w<span class="sc">$</span>f0[w<span class="sc">$</span>speaker <span class="sc">==</span> <span class="dv">107</span>], <span class="at">main =</span> <span class="st">&quot;Histogram of speaker 107&quot;</span>,</span>
<span id="cb50-35"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb50-35" aria-hidden="true" tabindex="-1"></a>      <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">140</span>, <span class="dv">310</span>), <span class="at">freq =</span> <span class="cn">FALSE</span>,<span class="at">col=</span>yellow)</span>
<span id="cb50-36"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb50-36" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span> (f0 <span class="sc">~</span> speaker, <span class="at">data =</span> w, <span class="at">main =</span> <span class="st">&quot;Speaker Boxplots&quot;</span>,<span class="at">col=</span>deepgreen, <span class="at">horizontal=</span><span class="cn">TRUE</span>,<span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">140</span>, <span class="dv">310</span>) )</span>
<span id="cb50-37"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb50-37" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span> (<span class="at">h =</span> <span class="dv">16</span>,<span class="at">lty=</span><span class="dv">3</span>)</span>
<span id="cb50-38"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb50-38" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span> (<span class="fu">tapply</span> (w<span class="sc">$</span>f0, w<span class="sc">$</span>speaker, mean), <span class="at">main =</span> <span class="st">&quot;Histogram of speaker f0 means&quot;</span>,<span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">140</span>, <span class="dv">310</span>), <span class="at">freq =</span> <span class="cn">FALSE</span>,</span>
<span id="cb50-39"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb50-39" aria-hidden="true" tabindex="-1"></a>      <span class="at">col=</span><span class="dv">4</span>)</span>
<span id="cb50-40"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb50-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-41"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb50-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-42"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb50-42" aria-hidden="true" tabindex="-1"></a><span class="do">################################################################################</span></span>
<span id="cb50-43"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb50-43" aria-hidden="true" tabindex="-1"></a><span class="do">### Figure 2.4</span></span>
<span id="cb50-44"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb50-44" aria-hidden="true" tabindex="-1"></a><span class="do">################################################################################</span></span>
<span id="cb50-45"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb50-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-46"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb50-46" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span> (<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>), <span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">4</span>,<span class="dv">4</span>,<span class="dv">3</span>,<span class="dv">1</span>))</span>
<span id="cb50-47"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb50-47" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span> (f0 <span class="sc">~</span> speaker, <span class="at">data =</span> w, <span class="at">main =</span> <span class="st">&quot;Speaker Boxplots&quot;</span>,<span class="at">col=</span>cols[<span class="dv">3</span><span class="sc">:</span><span class="dv">6</span>]) </span>
<span id="cb50-48"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb50-48" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span> (<span class="at">h =</span> <span class="fl">220.4</span>,<span class="at">lty=</span><span class="dv">3</span>, <span class="at">lwd=</span><span class="dv">3</span>)</span>
<span id="cb50-49"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb50-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-50"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb50-50" aria-hidden="true" tabindex="-1"></a><span class="do">################################################################################</span></span>
<span id="cb50-51"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb50-51" aria-hidden="true" tabindex="-1"></a><span class="do">### Figure 2.5</span></span>
<span id="cb50-52"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb50-52" aria-hidden="true" tabindex="-1"></a><span class="do">################################################################################</span></span>
<span id="cb50-53"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb50-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-54"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb50-54" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span> (<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>), <span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">4</span>,<span class="dv">4</span>,<span class="dv">2</span>,<span class="dv">1</span>))</span>
<span id="cb50-55"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb50-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-56"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb50-56" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span> (f0 <span class="sc">~</span> speaker, <span class="at">data =</span> w, <span class="at">main =</span> <span class="st">&quot;Speaker Boxplots&quot;</span>,<span class="at">col=</span><span class="fu">c</span>(yellow,coral,</span>
<span id="cb50-57"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb50-57" aria-hidden="true" tabindex="-1"></a>         deepgreen,teal)) </span>
<span id="cb50-58"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb50-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-59"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb50-59" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span> (<span class="at">h =</span> <span class="fl">220.4</span>, <span class="at">lwd=</span><span class="dv">3</span>,<span class="at">lty=</span><span class="dv">3</span>)</span>
<span id="cb50-60"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb50-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-61"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb50-61" aria-hidden="true" tabindex="-1"></a><span class="do">################################################################################</span></span>
<span id="cb50-62"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb50-62" aria-hidden="true" tabindex="-1"></a><span class="do">### Figure 2.6</span></span>
<span id="cb50-63"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb50-63" aria-hidden="true" tabindex="-1"></a><span class="do">################################################################################</span></span>
<span id="cb50-64"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb50-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-65"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb50-65" aria-hidden="true" tabindex="-1"></a><span class="co"># get t density</span></span>
<span id="cb50-66"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb50-66" aria-hidden="true" tabindex="-1"></a>x1 <span class="ot">=</span> <span class="fu">seq</span> (<span class="sc">-</span><span class="dv">4</span>,<span class="dv">4</span>,.<span class="dv">1</span>)</span>
<span id="cb50-67"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb50-67" aria-hidden="true" tabindex="-1"></a>y1 <span class="ot">=</span> <span class="fu">dt</span> (x1, <span class="dv">3</span>); y1 <span class="ot">=</span> y1 <span class="sc">/</span> <span class="fu">max</span> (y1) <span class="sc">/</span> <span class="dv">100</span></span>
<span id="cb50-68"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb50-68" aria-hidden="true" tabindex="-1"></a>x2 <span class="ot">=</span> <span class="dv">220</span><span class="sc">+</span>(x1<span class="sc">*</span><span class="dv">100</span>)</span>
<span id="cb50-69"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb50-69" aria-hidden="true" tabindex="-1"></a>y2 <span class="ot">=</span> <span class="fu">dnorm</span> (x2, <span class="dv">220</span>, <span class="dv">100</span>); y2 <span class="ot">=</span> y2 <span class="sc">/</span> <span class="fu">max</span> (y2) <span class="sc">/</span> <span class="dv">100</span></span>
<span id="cb50-70"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb50-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-71"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb50-71" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span> (<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>), <span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">4</span>,<span class="dv">4</span>,<span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb50-72"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb50-72" aria-hidden="true" tabindex="-1"></a><span class="do">## plot t</span></span>
<span id="cb50-73"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb50-73" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span> (x2, y1, <span class="at">type =</span> <span class="st">&#39;l&#39;</span>, <span class="at">lwd =</span> <span class="dv">2</span>, <span class="at">ylab =</span> <span class="st">&#39;Density&#39;</span>, <span class="at">xlab =</span> <span class="st">&#39;f0&#39;</span>, <span class="at">col =</span> <span class="dv">4</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.018</span>))</span>
<span id="cb50-74"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb50-74" aria-hidden="true" tabindex="-1"></a><span class="do">## compare to equivalent normal</span></span>
<span id="cb50-75"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb50-75" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span> (x2, y2, <span class="at">lwd=</span><span class="dv">2</span>,<span class="at">col=</span><span class="dv">2</span>)</span>
<span id="cb50-76"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb50-76" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span> (f0, <span class="at">add =</span> <span class="cn">TRUE</span>, <span class="at">freq =</span> <span class="cn">FALSE</span>, <span class="at">col =</span> deepgreen)</span>
<span id="cb50-77"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb50-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-78"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb50-78" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-79"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb50-79" aria-hidden="true" tabindex="-1"></a><span class="do">## plot prior for standard deviations</span></span>
<span id="cb50-80"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb50-80" aria-hidden="true" tabindex="-1"></a>x3 <span class="ot">=</span> x2 <span class="sc">-</span> <span class="fu">mean</span> (x2)</span>
<span id="cb50-81"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb50-81" aria-hidden="true" tabindex="-1"></a>y3 <span class="ot">=</span> <span class="fu">dt</span> (x1, <span class="dv">3</span>); y3 <span class="ot">=</span> y3 <span class="sc">/</span> <span class="fu">max</span> (y3) <span class="sc">/</span> <span class="dv">20</span></span>
<span id="cb50-82"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb50-82" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span> (x3[x3<span class="sc">&gt;</span><span class="dv">0</span>], y3[x3<span class="sc">&gt;</span><span class="dv">0</span>], <span class="at">type =</span> <span class="st">&#39;l&#39;</span>, <span class="at">lwd =</span> <span class="dv">2</span>, <span class="at">ylab =</span> <span class="st">&#39;Density&#39;</span>, </span>
<span id="cb50-83"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb50-83" aria-hidden="true" tabindex="-1"></a>      <span class="at">xlab =</span> <span class="st">&#39;f0&#39;</span>, <span class="at">col =</span> <span class="dv">4</span>)</span>
<span id="cb50-84"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb50-84" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span> (<span class="fu">abs</span> (f0 <span class="sc">-</span> <span class="fu">mean</span> (f0)), <span class="at">add =</span> <span class="cn">TRUE</span>, <span class="at">freq =</span> <span class="cn">FALSE</span>, <span class="at">col =</span> yellow)</span>
<span id="cb50-85"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb50-85" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-86"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb50-86" aria-hidden="true" tabindex="-1"></a><span class="do">################################################################################</span></span>
<span id="cb50-87"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb50-87" aria-hidden="true" tabindex="-1"></a><span class="do">### Figure 2.7</span></span>
<span id="cb50-88"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb50-88" aria-hidden="true" tabindex="-1"></a><span class="do">################################################################################</span></span>
<span id="cb50-89"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb50-89" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-90"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb50-90" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span> (<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>), <span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">4</span>,<span class="dv">4</span>,<span class="dv">2</span>,<span class="dv">1</span>))</span>
<span id="cb50-91"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb50-91" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-92"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb50-92" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span> (f0 <span class="sc">~</span> speaker, <span class="at">data =</span> w, <span class="at">main =</span> <span class="st">&quot;Speaker Boxplots&quot;</span>,<span class="at">col=</span><span class="fu">c</span>(yellow,coral,</span>
<span id="cb50-93"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb50-93" aria-hidden="true" tabindex="-1"></a>         deepgreen,teal)) </span>
<span id="cb50-94"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb50-94" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-95"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb50-95" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span> (<span class="at">h =</span> <span class="fl">220.4</span>, <span class="at">lwd=</span><span class="dv">3</span>,<span class="at">lty=</span><span class="dv">3</span>)</span>
<span id="cb50-96"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb50-96" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-97"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb50-97" aria-hidden="true" tabindex="-1"></a><span class="do">################################################################################</span></span>
<span id="cb50-98"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb50-98" aria-hidden="true" tabindex="-1"></a><span class="do">### Figure 2.8</span></span>
<span id="cb50-99"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb50-99" aria-hidden="true" tabindex="-1"></a><span class="do">################################################################################</span></span>
<span id="cb50-100"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb50-100" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-101"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb50-101" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span> (<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>), <span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">1</span>), <span class="at">oma =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">2</span>,<span class="dv">0</span>,<span class="dv">0</span>))</span>
<span id="cb50-102"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb50-102" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span> (f0_rep <span class="sc">~</span> speaker, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">140</span>,<span class="dv">320</span>), <span class="at">xaxt=</span><span class="st">&#39;n&#39;</span>,<span class="at">xlab=</span><span class="st">&#39;&#39;</span>,</span>
<span id="cb50-103"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb50-103" aria-hidden="true" tabindex="-1"></a>         <span class="at">col=</span><span class="fu">c</span>(yellow,coral,deepgreen,teal))</span>
<span id="cb50-104"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb50-104" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span> (<span class="at">h =</span> <span class="fl">220.4</span>, <span class="at">lwd=</span><span class="dv">3</span>,<span class="at">lty=</span><span class="dv">3</span>)</span>
<span id="cb50-105"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb50-105" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span> (f0 <span class="sc">~</span> speaker, <span class="at">data =</span> w, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">140</span>,<span class="dv">320</span>), <span class="at">xaxt=</span><span class="st">&#39;n&#39;</span>,<span class="at">xlab=</span><span class="st">&#39;&#39;</span>,</span>
<span id="cb50-106"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb50-106" aria-hidden="true" tabindex="-1"></a>         <span class="at">col=</span><span class="fu">c</span>(yellow,coral,deepgreen,teal))</span>
<span id="cb50-107"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb50-107" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span> (<span class="at">h =</span> <span class="fl">220.4</span>, <span class="at">lwd=</span><span class="dv">3</span>,<span class="at">lty=</span><span class="dv">3</span>)</span>
<span id="cb50-108"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb50-108" aria-hidden="true" tabindex="-1"></a><span class="fu">mtext</span> (<span class="at">text =</span> <span class="st">&quot;f0&quot;</span>, <span class="at">side=</span><span class="dv">2</span>, <span class="at">outer=</span><span class="cn">TRUE</span>, <span class="at">line =</span> <span class="dv">1</span>)</span>
<span id="cb50-109"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb50-109" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-110"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb50-110" aria-hidden="true" tabindex="-1"></a><span class="do">################################################################################</span></span>
<span id="cb50-111"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb50-111" aria-hidden="true" tabindex="-1"></a><span class="do">### Figure 2.9</span></span>
<span id="cb50-112"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb50-112" aria-hidden="true" tabindex="-1"></a><span class="do">################################################################################</span></span>
<span id="cb50-113"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb50-113" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-114"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb50-114" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span> (<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">1</span>), <span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">1</span>,<span class="dv">1</span>), <span class="at">oma =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">2</span>,<span class="dv">0</span>,<span class="dv">0</span>))</span>
<span id="cb50-115"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb50-115" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span> (f0_rep_1 <span class="sc">~</span> speaker, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">140</span>,<span class="dv">320</span>),<span class="at">xaxt=</span><span class="st">&#39;n&#39;</span>,</span>
<span id="cb50-116"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb50-116" aria-hidden="true" tabindex="-1"></a>         <span class="at">col=</span><span class="fu">c</span>(yellow,coral,deepgreen,teal))</span>
<span id="cb50-117"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb50-117" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span> (<span class="dv">5</span>, <span class="dv">290</span>, <span class="at">label =</span> <span class="fu">expression</span>(<span class="fu">paste</span>(sigma[<span class="st">&quot;error&quot;</span>])), <span class="at">cex =</span> <span class="fl">1.5</span>)</span>
<span id="cb50-118"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb50-118" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span> (<span class="at">h=</span><span class="dv">220</span>,<span class="at">lty=</span><span class="dv">2</span>)</span>
<span id="cb50-119"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb50-119" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-120"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb50-120" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span> (f0_rep_2 <span class="sc">~</span> speaker, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">140</span>,<span class="dv">320</span>),<span class="at">xaxt=</span><span class="st">&#39;n&#39;</span>,</span>
<span id="cb50-121"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb50-121" aria-hidden="true" tabindex="-1"></a>         <span class="at">col=</span><span class="fu">c</span>(yellow,coral,deepgreen,teal))</span>
<span id="cb50-122"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb50-122" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span> (<span class="at">h=</span><span class="dv">220</span>,<span class="at">lty=</span><span class="dv">2</span>)</span>
<span id="cb50-123"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb50-123" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span> (<span class="dv">5</span>, <span class="dv">290</span>, <span class="at">label =</span> <span class="fu">expression</span>(<span class="fu">paste</span>(sigma[<span class="st">&quot;speaker&quot;</span>])), <span class="at">cex =</span> <span class="fl">1.5</span>)</span>
<span id="cb50-124"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb50-124" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-125"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb50-125" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span> (f0_rep <span class="sc">~</span> speaker, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">140</span>,<span class="dv">320</span>),<span class="at">xaxt=</span><span class="st">&#39;n&#39;</span>,</span>
<span id="cb50-126"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb50-126" aria-hidden="true" tabindex="-1"></a>         <span class="at">col=</span><span class="fu">c</span>(yellow,coral,deepgreen,teal)  )</span>
<span id="cb50-127"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb50-127" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span> (<span class="at">h=</span><span class="dv">220</span>,<span class="at">lty=</span><span class="dv">2</span>)</span>
<span id="cb50-128"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb50-128" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span> (<span class="dv">5</span>, <span class="dv">290</span>, <span class="at">label =</span> <span class="fu">expression</span>(<span class="fu">paste</span>(sigma[<span class="st">&quot;error&quot;</span>]<span class="sc">+</span>sigma[<span class="st">&quot;speaker&quot;</span>])), <span class="at">cex =</span> <span class="fl">1.5</span>)</span>
<span id="cb50-129"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb50-129" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-130"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb50-130" aria-hidden="true" tabindex="-1"></a><span class="fu">mtext</span> (<span class="at">side=</span><span class="dv">2</span>,<span class="at">text=</span><span class="st">&quot;f0&quot;</span>, <span class="at">outer =</span> <span class="cn">TRUE</span>, <span class="at">line=</span><span class="dv">0</span>)</span></code></pre></div>

<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb51-1" aria-hidden="true" tabindex="-1"></a>url1 <span class="ot">=</span> <span class="st">&quot;https://raw.githubusercontent.com/santiagobarreda&quot;</span></span>
<span id="cb51-2"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb51-2" aria-hidden="true" tabindex="-1"></a>url2 <span class="ot">=</span> <span class="st">&quot;/stats-class/master/data/h95_vowel_data.csv&quot;</span></span>
<span id="cb51-3"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb51-3" aria-hidden="true" tabindex="-1"></a><span class="co"># set up colors for plotting</span></span>
<span id="cb51-4"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb51-4" aria-hidden="true" tabindex="-1"></a>devtools<span class="sc">::</span><span class="fu">source_url</span> (<span class="fu">paste0</span> (url1, <span class="st">&quot;/stats-class/master/data/colors.R&quot;</span>))</span>
<span id="cb51-5"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb51-5" aria-hidden="true" tabindex="-1"></a><span class="co"># source functions</span></span>
<span id="cb51-6"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb51-6" aria-hidden="true" tabindex="-1"></a>devtools<span class="sc">::</span><span class="fu">source_url</span> (<span class="fu">paste0</span> (url1, <span class="st">&quot;/stats-class/master/data/functions.R&quot;</span>))</span></code></pre></div>
</div>
</div>
<!-- Default Statcounter code for statsbook
https://santiagobarreda.github.io/stats-class/ -->
<script type="text/javascript">
var sc_project=12454226; 
var sc_invisible=1; 
var sc_security="a1959418"; 
</script>
<script type="text/javascript"
src="https://www.statcounter.com/counter/counter.js"
async></script>
<noscript><div class="statcounter"><a title="Web Analytics"
href="https://statcounter.com/" target="_blank"><img
class="statcounter"
src="https://c.statcounter.com/12454226/0/a1959418/1/"
alt="Web Analytics"></a></div></noscript>
<!-- End of Statcounter Code -->
            </section>

          </div>
        </div>
      </div>
<a href="inspecting-a-single-group-of-observations.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="comparing-two-groups-of-observations.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
